import{j as e}from"./vendor-ui-DJm-zmnP.js";import{r as a}from"./vendor-react-Bzsngnqy.js";import{l as De,e as Xe,c as Je,q as Y,C as p,x as u,y as j,W as b,f as N,L as n,I as i,B as l,P as Fe,ah as z,i as S,j as ee,aF as Le,a0 as Ue,a1 as P,a3 as $e,ao as qe,ap as Ye,v,at as es,ae as ss,a5 as as,au as ts,S as ns,N as f}from"./index-61RjstaY.js";import{S as K}from"./switch-BuAF3IBh.js";import{a as se,b as E}from"./vendor-query-CX8ZYlKb.js";import{S as y,a as w,b as C,c as k,d}from"./select-BgcBxbEj.js";import{P as ls}from"./panels-top-left-QfRWgU-9.js";import{S as is}from"./store-CdbJ-YqS.js";import{E as ze}from"./external-link-JZzpsg7W.js";import{C as ae}from"./circle-check-big-v7jPXABl.js";import{E as ds}from"./eye-off-D4nLDnly.js";import{E as rs}from"./eye-A6WRE6cq.js";import{W as cs}from"./wifi-DHeSyR6a.js";import{C as os}from"./circle-x-D9GYVDcC.js";import{P as Ke}from"./palette-C7Jo7bUI.js";import{U as te}from"./users-Btf_-tK9.js";import"./vendor-utils-BKCsaWdX.js";import"./chevron-down-BsuQiE4E.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=De("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=De("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);function Bs(){const{toast:o}=Xe(),[,ne]=Je(),{data:g,isLoading:Qe}=se({queryKey:["/api/business-config"]}),{data:D=[],isLoading:hs}=se({queryKey:["/api/menu-categories"]}),I=D.filter(s=>s.department==="drinks"||!s.department),A=D.filter(s=>s.department==="food");console.log("Admin Categories:",{total:D.length,drinks:I.map(s=>s.nameAr),food:A.map(s=>s.nameAr)});const{data:t,isLoading:gs}=se({queryKey:["/api/payment-gateway/config"]}),[x,le]=a.useState("none"),[ie,de]=a.useState(!0),[re,ce]=a.useState(!0),[oe,xe]=a.useState(!0),[me,he]=a.useState(!1),[ge,pe]=a.useState(!1),[T,Re]=a.useState(""),[M,Ve]=a.useState(""),[Q,ue]=a.useState(""),[R,je]=a.useState("https://api.neoleap.com.sa"),[B,Ge]=a.useState(""),[F,We]=a.useState(""),[V,be]=a.useState("https://api.merchant.geidea.net"),[m,Oe]=a.useState(!1),[Ne,ve]=a.useState(!1),[L,G]=a.useState(null);a.useEffect(()=>{t&&(le(t.provider||"none"),de(t.cashEnabled!==!1),ce(t.posEnabled!==!1),xe(t.qahwaCardEnabled!==!1),he(t.bankTransferEnabled||!1),pe(t.stcPayEnabled||!1),t.neoleap&&(ue(t.neoleap.merchantId||""),je(t.neoleap.baseUrl||"https://api.neoleap.com.sa")),t.geidea&&be(t.geidea.baseUrl||"https://api.merchant.geidea.net"))},[t]);const U=E({mutationFn:async s=>(await v("PATCH","/api/payment-gateway/config",s)).json(),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/payment-gateway/config"]}),f.invalidateQueries({queryKey:["/api/payment-methods"]}),o({title:"تم الحفظ",description:"تم حفظ إعدادات الدفع بنجاح"})},onError:s=>{o({title:"خطأ",description:s.message,variant:"destructive"})}}),He=()=>{const s={provider:x,cashEnabled:ie,posEnabled:re,qahwaCardEnabled:oe,bankTransferEnabled:me,stcPayEnabled:ge};T&&!T.startsWith("****")&&(s.neoleapClientId=T),M&&!M.startsWith("****")&&(s.neoleapClientSecret=M),Q&&(s.neoleapMerchantId=Q),R&&(s.neoleapBaseUrl=R),B&&!B.startsWith("****")&&(s.geideaPublicKey=B),F&&!F.startsWith("****")&&(s.geideaApiPassword=F),V&&(s.geideaBaseUrl=V),U.mutate(s)},Ze=async()=>{ve(!0),G(null);try{const c=await(await v("POST","/api/payment-gateway/test",{})).json();G(c)}catch{G({success:!1,message:"فشل في الاتصال"})}finally{ve(!1)}},[_e,W]=a.useState(!1),[O,fe]=a.useState(""),[ye,H]=a.useState(!1),[$,Z]=a.useState(""),[we,_]=a.useState(""),[Ce,ke]=a.useState("drinks"),[Se,Pe]=a.useState("Coffee"),[Ee,X]=a.useState(null),[Ie,q]=a.useState("drinks"),r=E({mutationFn:async s=>(await v("PATCH","/api/business-config",s)).json(),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/business-config"]}),o({title:"تم التحديث",description:"تم حفظ التغييرات بنجاح"})},onError:s=>{o({title:"خطأ",description:s.message,variant:"destructive"})}}),J=E({mutationFn:async s=>v("POST","/api/menu-categories",s),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/menu-categories"]}),H(!1),Z(""),_(""),ke("drinks"),Pe("Coffee"),o({title:"تم إضافة القسم الفرعي بنجاح"})},onError:()=>{o({title:"فشل في إضافة القسم",variant:"destructive"})}}),Ae=E({mutationFn:async({id:s,data:c})=>v("PUT",`/api/menu-categories/${s}`,c),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/menu-categories"]}),X(null),o({title:"تم تحديث القسم بنجاح"})},onError:()=>{o({title:"فشل في تحديث القسم",variant:"destructive"})}}),Te=E({mutationFn:async s=>v("DELETE",`/api/menu-categories/${s}`),onSuccess:()=>{f.invalidateQueries({queryKey:["/api/menu-categories"]}),o({title:"تم حذف القسم بنجاح"})},onError:()=>{o({title:"فشل في حذف القسم",variant:"destructive"})}}),Me=[{value:"Coffee",label:"قهوة",Icon:S},{value:"Flame",label:"ساخن",Icon:es},{value:"Snowflake",label:"بارد",Icon:ss},{value:"Star",label:"مميز",Icon:as},{value:"Cake",label:"حلويات",Icon:ts},{value:"Utensils",label:"مأكولات",Icon:z},{value:"Sparkles",label:"خاص",Icon:ns}],Be=s=>{const c=Me.find(h=>h.value===s);return c?c.Icon:S};return Qe?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-white dark:bg-background",children:e.jsx(Y,{className:"w-8 h-8 animate-spin text-accent"})}):e.jsxs("div",{className:"p-6 space-y-6 bg-white dark:bg-background min-h-screen",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold font-ibm-arabic",children:"إدارة الموقع والنظام"}),e.jsx("p",{className:"text-muted-foreground mt-1 font-ibm-arabic text-sm",children:"تخصيص كامل للهوية، نوع النشاط، وحالة النظام"})]}),e.jsx("div",{className:"bg-accent/10 p-3 rounded-full",children:e.jsx(ls,{className:"w-6 h-6 text-accent"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(p,{className:"hover-elevate border-orange-100 dark:border-orange-900/30",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/20 rounded-lg",children:e.jsx(ms,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx(j,{className:"text-lg font-bold",children:"حالة النظام"}),e.jsx(b,{children:"تفعيل وضع الصيانة أو التحديث"})]})]}),e.jsx(K,{checked:g?.isMaintenanceMode,onCheckedChange:s=>r.mutate({isMaintenanceMode:s}),disabled:r.isPending,className:"data-[state=checked]:bg-orange-600"})]})}),e.jsxs(N,{className:"space-y-4 pt-2",children:[e.jsx("div",{className:"p-3 bg-orange-50 dark:bg-orange-900/10 rounded-lg text-xs text-orange-800 dark:text-orange-300",children:"عند التفعيل، سيتم تحويل جميع العملاء تلقائياً لصفحة التوقف المؤقت."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"رسالة الحالة للعملاء"}),e.jsxs(y,{value:g?.maintenanceReason||"maintenance",onValueChange:s=>r.mutate({maintenanceReason:s}),disabled:r.isPending,children:[e.jsx(w,{className:"font-ibm-arabic",children:e.jsx(C,{placeholder:"اختر السبب"})}),e.jsxs(k,{className:"font-ibm-arabic",children:[e.jsx(d,{value:"maintenance",children:"الموقع خارج الخدمة حالياً (صيانة)"}),e.jsx(d,{value:"development",children:"الموقع تحت التطوير حالياً"}),e.jsx(d,{value:"update",children:"جاري تحديث الموقع حالياً"})]})]})]})]})]}),e.jsxs(p,{className:"hover-elevate border-blue-100 dark:border-blue-900/30",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:e.jsx(is,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx(j,{className:"text-lg font-bold",children:"تخصيص النشاط"}),e.jsx(b,{children:"تحديد نوع النظام والتحكم في الأقسام"})]})]})}),e.jsxs(N,{className:"space-y-4 pt-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"نوع النشاط التجاري"}),e.jsxs(y,{value:g?.activityType||"cafe",onValueChange:s=>r.mutate({activityType:s}),disabled:r.isPending,children:[e.jsx(w,{className:"font-ibm-arabic",children:e.jsx(C,{placeholder:"اختر نوع النشاط"})}),e.jsxs(k,{className:"font-ibm-arabic",children:[e.jsx(d,{value:"cafe",children:"نظام كافيه فقط"}),e.jsx(d,{value:"restaurant",children:"نظام مطعم فقط"}),e.jsx(d,{value:"both",children:"نظام مطعم وكافيه معاً"})]})]})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/10 rounded-lg space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-bold text-blue-800 dark:text-blue-300",children:"أقسام النظام المتاحة"}),e.jsx("div",{className:"flex gap-2",children:_e?e.jsxs("div",{className:"flex items-center gap-1 animate-in slide-in-from-left-2",children:[e.jsx(i,{size:1,className:"h-7 text-xs w-24",placeholder:"اسم القسم...",value:O,onChange:s=>fe(s.target.value)}),e.jsx(l,{size:"sm",className:"h-7 px-2",onClick:()=>{O.trim()&&(o({title:"تمت الإضافة",description:`تم إضافة قسم ${O} بنجاح`}),fe(""),W(!1))},children:"حفظ"}),e.jsx(l,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:()=>W(!1),children:"إلغاء"})]}):e.jsxs(l,{size:"sm",variant:"ghost",className:"h-7 text-xs text-blue-700 hover:bg-blue-100",onClick:()=>W(!0),children:[e.jsx(Fe,{className:"w-3 h-3 ml-1"}),"إضافة قسم"]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-xs",children:"إدارة المأكولات"})]}),e.jsx(K,{checked:g?.isFoodEnabled,onCheckedChange:s=>r.mutate({isFoodEnabled:s}),disabled:r.isPending})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-xs",children:"إدارة المشروبات"})]}),e.jsx(K,{checked:g?.isDrinksEnabled,onCheckedChange:s=>r.mutate({isDrinksEnabled:s}),disabled:r.isPending})]})]})]})]})]}),e.jsxs(p,{className:"hover-elevate border-teal-100 dark:border-teal-900/30 md:col-span-2",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-teal-100 dark:bg-teal-900/20 rounded-lg",children:e.jsx(xs,{className:"w-5 h-5 text-teal-600"})}),e.jsxs("div",{children:[e.jsx(j,{className:"text-lg font-bold",children:"إدارة الأقسام الفرعية"}),e.jsx(b,{children:"إضافة وتعديل أقسام المنيو وتعيينها لإدارة المشروبات أو المأكولات"})]})]}),e.jsxs(l,{size:"sm",onClick:()=>H(!0),disabled:ye,"data-testid":"button-add-menu-category",children:[e.jsx(Fe,{className:"w-4 h-4 ml-1"}),"إضافة قسم"]})]})}),e.jsxs(N,{className:"space-y-4 pt-2",children:[ye&&e.jsxs("div",{className:"p-4 bg-teal-50/50 dark:bg-teal-900/10 rounded-lg border border-teal-200 dark:border-teal-800 space-y-3",children:[e.jsx(n,{className:"text-sm font-bold text-teal-800 dark:text-teal-300",children:"إضافة قسم فرعي جديد"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(n,{className:"text-xs",children:"اسم القسم (عربي)"}),e.jsx(i,{value:$,onChange:s=>Z(s.target.value),placeholder:"مثال: مشروبات خاصة",className:"text-right","data-testid":"input-new-category-name-ar"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(n,{className:"text-xs",children:"اسم القسم (إنجليزي) - اختياري"}),e.jsx(i,{value:we,onChange:s=>_(s.target.value),placeholder:"e.g. Special Drinks","data-testid":"input-new-category-name-en"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(n,{className:"text-xs",children:"تابع لقسم"}),e.jsxs(y,{value:Ce,onValueChange:s=>ke(s),children:[e.jsx(w,{"data-testid":"select-new-category-department",children:e.jsx(C,{})}),e.jsxs(k,{children:[e.jsx(d,{value:"drinks",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{children:"إدارة المشروبات"})]})}),e.jsx(d,{value:"food",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{children:"إدارة المأكولات"})]})})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(n,{className:"text-xs",children:"الأيقونة"}),e.jsxs(y,{value:Se,onValueChange:Pe,children:[e.jsx(w,{"data-testid":"select-new-category-icon",children:e.jsx(C,{})}),e.jsx(k,{children:Me.map(s=>e.jsx(d,{value:s.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s.Icon,{className:"w-4 h-4"}),e.jsx("span",{children:s.label})]})},s.value))})]})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-1",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{H(!1),Z(""),_("")},"data-testid":"button-cancel-add-category",children:"إلغاء"}),e.jsx(l,{size:"sm",onClick:()=>{$.trim()&&J.mutate({nameAr:$.trim(),nameEn:we.trim()||void 0,icon:Se,department:Ce})},disabled:!$.trim()||J.isPending,"data-testid":"button-save-new-category",children:J.isPending?"جاري الحفظ...":"حفظ القسم"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-1",children:[e.jsx(S,{className:"w-4 h-4 text-teal-600"}),e.jsx(n,{className:"text-sm font-bold",children:"أقسام إدارة المشروبات"}),e.jsx(ee,{variant:"secondary",className:"text-[10px]",children:I.length})]}),I.length===0&&e.jsx("p",{className:"text-xs text-muted-foreground py-3 text-center",children:"لا توجد أقسام فرعية بعد"}),I.map(s=>{const c=Be(s.icon||"Coffee");return e.jsxs("div",{className:"flex items-center justify-between p-2.5 bg-card border rounded-lg group","data-testid":`category-item-${s.id}`,children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-teal-50 dark:bg-teal-900/20 flex items-center justify-center",children:e.jsx(c,{className:"w-4 h-4 text-teal-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:s.nameAr}),s.nameEn&&e.jsxs("span",{className:"text-xs text-muted-foreground mr-2",children:["(",s.nameEn,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[Ee===s.id?e.jsxs(y,{value:Ie,onValueChange:h=>{q(h),Ae.mutate({id:s.id,data:{department:h}})},children:[e.jsx(w,{className:"h-7 text-xs w-32","data-testid":`select-edit-dept-${s.id}`,children:e.jsx(C,{})}),e.jsxs(k,{children:[e.jsx(d,{value:"drinks",children:"المشروبات"}),e.jsx(d,{value:"food",children:"المأكولات"})]})]}):e.jsx(l,{size:"icon",variant:"ghost",onClick:()=>{X(s.id),q(s.department||"drinks")},"data-testid":`button-edit-category-${s.id}`,children:e.jsx(Le,{className:"w-3.5 h-3.5"})}),e.jsx(l,{size:"icon",variant:"ghost",onClick:()=>{confirm("هل أنت متأكد من حذف هذا القسم؟")&&Te.mutate(s.id)},"data-testid":`button-delete-category-${s.id}`,children:e.jsx(Ue,{className:"w-3.5 h-3.5 text-destructive"})})]})]},s.id)})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-1",children:[e.jsx(z,{className:"w-4 h-4 text-orange-600"}),e.jsx(n,{className:"text-sm font-bold",children:"أقسام إدارة المأكولات"}),e.jsx(ee,{variant:"secondary",className:"text-[10px]",children:A.length})]}),A.length===0&&e.jsx("p",{className:"text-xs text-muted-foreground py-3 text-center",children:"لا توجد أقسام فرعية بعد"}),A.map(s=>{const c=Be(s.icon||"Utensils");return e.jsxs("div",{className:"flex items-center justify-between p-2.5 bg-card border rounded-lg group","data-testid":`category-item-${s.id}`,children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-orange-50 dark:bg-orange-900/20 flex items-center justify-center",children:e.jsx(c,{className:"w-4 h-4 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:s.nameAr}),s.nameEn&&e.jsxs("span",{className:"text-xs text-muted-foreground mr-2",children:["(",s.nameEn,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[Ee===s.id?e.jsxs(y,{value:Ie,onValueChange:h=>{q(h),Ae.mutate({id:s.id,data:{department:h}})},children:[e.jsx(w,{className:"h-7 text-xs w-32","data-testid":`select-edit-dept-${s.id}`,children:e.jsx(C,{})}),e.jsxs(k,{children:[e.jsx(d,{value:"drinks",children:"المشروبات"}),e.jsx(d,{value:"food",children:"المأكولات"})]})]}):e.jsx(l,{size:"icon",variant:"ghost",onClick:()=>{X(s.id),q(s.department||"food")},"data-testid":`button-edit-category-${s.id}`,children:e.jsx(Le,{className:"w-3.5 h-3.5"})}),e.jsx(l,{size:"icon",variant:"ghost",onClick:()=>{confirm("هل أنت متأكد من حذف هذا القسم؟")&&Te.mutate(s.id)},"data-testid":`button-delete-category-${s.id}`,children:e.jsx(Ue,{className:"w-3.5 h-3.5 text-destructive"})})]})]},s.id)})]})]})]})]}),e.jsxs(p,{className:"border-indigo-100 dark:border-indigo-900/30 md:col-span-2",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-100 dark:bg-indigo-900/20 rounded-lg",children:e.jsx(P,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx(j,{className:"text-lg font-bold",children:"إدارة طرق الدفع وبوابة الدفع"}),e.jsx(b,{children:"اختر مزود الدفع الإلكتروني وادخل بيانات الاعتماد"})]})]}),t&&e.jsx(ee,{variant:t.provider!=="none"&&(t.neoleap?.configured||t.geidea?.configured)?"default":"secondary",children:t.provider==="neoleap"?"NeoLeap":t.provider==="geidea"?"Geidea":"غير مفعّل"})]})}),e.jsxs(N,{className:"space-y-6 pt-2",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{className:"text-sm font-bold",children:"مزود الدفع الإلكتروني"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[{id:"none",label:"بدون بوابة",desc:"كاش فقط",icon:$e},{id:"neoleap",label:"NeoLeap (نيو ليب)",desc:"مدى، فيزا، ماستر كارد",icon:P},{id:"geidea",label:"Geidea (جيديا)",desc:"مدى، فيزا، ماستر كارد",icon:P}].map(s=>e.jsxs("div",{className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${x===s.id?"border-indigo-500 bg-indigo-50 dark:bg-indigo-950/30":"border-border hover:border-indigo-300"}`,onClick:()=>le(s.id),"data-testid":`payment-provider-${s.id}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(s.icon,{className:`w-4 h-4 ${x===s.id?"text-indigo-600":"text-muted-foreground"}`}),e.jsx("span",{className:`text-sm font-bold ${x===s.id?"text-indigo-700 dark:text-indigo-400":""}`,children:s.label})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.desc})]},s.id))})]}),x==="neoleap"&&e.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-900/30 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[e.jsx(n,{className:"text-sm font-bold text-indigo-700 dark:text-indigo-400",children:"إعدادات NeoLeap (نيو ليب)"}),e.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>window.open("https://developers.neoleap.com.sa/","_blank"),"data-testid":"link-neoleap-portal",children:[e.jsx(ze,{className:"w-3 h-3 ml-1"}),"بوابة المطورين"]})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/30 rounded border border-blue-200 dark:border-blue-800 text-xs space-y-1",children:[e.jsx("p",{className:"font-bold text-blue-800 dark:text-blue-300",children:"كيف تحصل على بيانات الاعتماد:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-0.5 text-blue-700 dark:text-blue-400",children:[e.jsxs("li",{children:["سجّل حساب مطور في ",e.jsx("span",{className:"font-mono",children:"developers.neoleap.com.sa"})]}),e.jsx("li",{children:"فعّل حسابك عبر البريد الإلكتروني"}),e.jsx("li",{children:"اشترك في الخطة المناسبة وانتظر الموافقة"}),e.jsx("li",{children:"احصل على Client ID و Client Secret من لوحة التحكم"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(n,{className:"text-xs",children:"Client ID"}),e.jsx("div",{className:"relative",children:e.jsx(i,{type:m?"text":"password",value:T,onChange:s=>Re(s.target.value),placeholder:t?.neoleap?.configured?t.neoleap.clientId:"أدخل Client ID",className:"text-xs font-mono","data-testid":"input-neoleap-client-id"})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(n,{className:"text-xs",children:"Client Secret"}),e.jsx(i,{type:m?"text":"password",value:M,onChange:s=>Ve(s.target.value),placeholder:"أدخل Client Secret",className:"text-xs font-mono","data-testid":"input-neoleap-client-secret"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(n,{className:"text-xs",children:"Merchant ID (اختياري)"}),e.jsx(i,{value:Q,onChange:s=>ue(s.target.value),placeholder:"معرّف التاجر",className:"text-xs font-mono","data-testid":"input-neoleap-merchant-id"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(n,{className:"text-xs",children:"Base URL"}),e.jsx(i,{value:R,onChange:s=>je(s.target.value),className:"text-xs font-mono","data-testid":"input-neoleap-base-url"})]})]}),t?.neoleap?.configured&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600",children:[e.jsx(ae,{className:"w-3 h-3"}),e.jsx("span",{children:"بيانات الاعتماد محفوظة"})]})]}),x==="geidea"&&e.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 dark:bg-gray-900/30 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[e.jsx(n,{className:"text-sm font-bold text-indigo-700 dark:text-indigo-400",children:"إعدادات Geidea (جيديا)"}),e.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>window.open("https://docs.geidea.net/docs/overview","_blank"),"data-testid":"link-geidea-docs",children:[e.jsx(ze,{className:"w-3 h-3 ml-1"}),"وثائق جيديا"]})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/30 rounded border border-blue-200 dark:border-blue-800 text-xs space-y-1",children:[e.jsx("p",{className:"font-bold text-blue-800 dark:text-blue-300",children:"كيف تحصل على بيانات الاعتماد:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-0.5 text-blue-700 dark:text-blue-400",children:[e.jsx("li",{children:"سجّل الدخول في بوابة التاجر من جيديا"}),e.jsx("li",{children:"اذهب إلى Payment Gateway ثم Gateway Settings"}),e.jsx("li",{children:"انسخ Public Key و API Password"}),e.jsxs("li",{children:["أو تواصل مع ",e.jsx("span",{className:"font-mono",children:"support@geidea.net"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(n,{className:"text-xs",children:"Public Key (المفتاح العام)"}),e.jsx(i,{type:m?"text":"password",value:B,onChange:s=>Ge(s.target.value),placeholder:t?.geidea?.configured?t.geidea.publicKey:"أدخل المفتاح العام",className:"text-xs font-mono","data-testid":"input-geidea-public-key"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(n,{className:"text-xs",children:"API Password (كلمة مرور API)"}),e.jsx(i,{type:m?"text":"password",value:F,onChange:s=>We(s.target.value),placeholder:"أدخل كلمة مرور API",className:"text-xs font-mono","data-testid":"input-geidea-api-password"})]}),e.jsxs("div",{className:"space-y-1.5 sm:col-span-2",children:[e.jsx(n,{className:"text-xs",children:"Base URL"}),e.jsx(i,{value:V,onChange:s=>be(s.target.value),className:"text-xs font-mono","data-testid":"input-geidea-base-url"})]})]}),t?.geidea?.configured&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600",children:[e.jsx(ae,{className:"w-3 h-3"}),e.jsx("span",{children:"بيانات الاعتماد محفوظة"})]})]}),x!=="none"&&e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:e.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>Oe(!m),children:[m?e.jsx(ds,{className:"w-3 h-3 ml-1"}):e.jsx(rs,{className:"w-3 h-3 ml-1"}),m?"إخفاء البيانات":"إظهار البيانات"]})}),e.jsxs("div",{className:"space-y-3 p-4 bg-muted/30 rounded-lg border",children:[e.jsx(n,{className:"text-sm font-bold",children:"طرق الدفع المتاحة للعملاء"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[{key:"cashEnabled",label:"الدفع نقداً (كاش)",icon:$e,value:ie,setter:de},{key:"posEnabled",label:"جهاز نقاط البيع (POS)",icon:qe,value:re,setter:ce},{key:"qahwaCardEnabled",label:"بطاقة كلوني كافيه",icon:P,value:oe,setter:xe},{key:"stcPayEnabled",label:"STC Pay",icon:qe,value:ge,setter:pe},{key:"bankTransferEnabled",label:"تحويل بنكي",icon:P,value:me,setter:he}].map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-800 rounded border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s.icon,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-xs",children:s.label})]}),e.jsx(K,{checked:s.value,onCheckedChange:s.setter,disabled:U.isPending})]},s.key))}),x!=="none"&&e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:["البطاقة البنكية و Apple Pay ستظهر تلقائياً عند تفعيل بوابة ",x==="neoleap"?"نيو ليب":"جيديا"," وإدخال البيانات"]})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap pt-2",children:[e.jsxs(l,{onClick:He,disabled:U.isPending,"data-testid":"button-save-payment-config",children:[U.isPending?e.jsx(Y,{className:"w-4 h-4 animate-spin ml-1"}):e.jsx(Ye,{className:"w-4 h-4 ml-1"}),"حفظ إعدادات الدفع"]}),x!=="none"&&e.jsxs(l,{variant:"outline",onClick:Ze,disabled:Ne,"data-testid":"button-test-payment-connection",children:[Ne?e.jsx(Y,{className:"w-4 h-4 animate-spin ml-1"}):e.jsx(cs,{className:"w-4 h-4 ml-1"}),"اختبار الاتصال"]}),L&&e.jsxs("div",{className:`flex items-center gap-1 text-xs ${L.success?"text-green-600":"text-destructive"}`,children:[L.success?e.jsx(ae,{className:"w-3 h-3"}):e.jsx(os,{className:"w-3 h-3"}),e.jsx("span",{children:L.message})]})]})]})]}),e.jsxs(p,{className:"hover-elevate border-purple-100 dark:border-purple-900/30",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/20 rounded-lg",children:e.jsx(Ke,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx(j,{className:"text-lg font-bold",children:"الهوية البصرية"}),e.jsx(b,{children:"التحكم في الألوان والاسم والشعار"})]})]})}),e.jsxs(N,{className:"space-y-4 pt-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"اسم المنشأة التجاري (عربي)"}),e.jsx(i,{value:g?.tradeNameAr||"",onChange:s=>r.mutate({tradeNameAr:s.target.value}),placeholder:"مثال: كلاوني كافيه",className:"font-ibm-arabic"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-xs",children:"اللون الأساسي (أزرار/تفاعل)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{type:"color",className:"w-10 h-10 p-1 rounded cursor-pointer",value:"#8B5A2B",disabled:!0}),e.jsx(i,{value:"#8B5A2B",className:"text-xs font-mono",disabled:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{className:"text-xs",children:"لون الخلفية (الرئيسي)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{type:"color",className:"w-10 h-10 p-1 rounded cursor-pointer",value:"#F7F8F8",disabled:!0}),e.jsx(i,{value:"#F7F8F8",className:"text-xs font-mono",disabled:!0})]})]})]}),e.jsx("div",{className:"pt-2",children:e.jsxs(l,{variant:"outline",className:"w-full text-xs gap-2",children:[e.jsx(Ke,{className:"w-3 h-3"}),"تخصيص شكل الباركود (QR)"]})})]})]}),e.jsxs(p,{className:"hover-elevate border-green-100 dark:border-green-900/30",children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/20 rounded-lg",children:e.jsx(te,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx(j,{className:"text-lg font-bold",children:"إدارة المستخدمين"}),e.jsx(b,{children:"التحكم في الموظفين والعملاء"})]})]})}),e.jsx(N,{className:"space-y-4 pt-2",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(l,{variant:"outline",className:"justify-between group hover:border-accent font-ibm-arabic",onClick:()=>ne("/manager/employees"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4 text-muted-foreground group-hover:text-accent"}),e.jsx("span",{children:"إدارة طاقم العمل والموظفين"})]}),e.jsx("div",{className:"px-2 py-1 bg-green-50 text-green-700 text-[10px] rounded-full",children:"نشط"})]}),e.jsxs(l,{variant:"outline",className:"justify-start gap-2 group hover:border-accent font-ibm-arabic",children:[e.jsx(te,{className:"w-4 h-4 text-muted-foreground group-hover:text-accent"}),e.jsx("span",{children:"إدارة قاعدة بيانات العملاء والولاء"})]}),e.jsx(l,{variant:"ghost",className:"text-xs text-muted-foreground hover:text-accent font-ibm-arabic",onClick:()=>ne("/admin/branches"),children:"انتقال إلى إدارة الفروع والتراخيص →"})]})})]})]}),e.jsxs("div",{className:"text-center pt-10 text-muted-foreground text-xs font-ibm-arabic",children:[e.jsx("p",{children:"نظام كلاوني - جميع التغييرات يتم تطبيقها فوراً على واجهة العميل"}),r.isPending&&e.jsx("p",{className:"text-accent animate-pulse mt-2",children:"جاري حفظ التعديلات..."})]})]})}export{Bs as default};
