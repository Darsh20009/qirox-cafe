import{j as e}from"./vendor-ui-DJm-zmnP.js";import{r as s}from"./vendor-react-Bzsngnqy.js";import{c as k,e as E,C as L,x as q,i as F,y as I,V as O,f as T,L as l,I as c,B as f,v as B}from"./index-CLvpp2UE.js";import{P as D}from"./phone-input-C_eDBAZg.js";import{E as j}from"./eye-off-AEXWPIZp.js";import{E as b}from"./eye-cZNGFzyE.js";import{U as R}from"./user-plus-DA7dJ8qn.js";import"./vendor-query-CX8ZYlKb.js";import"./vendor-utils-BKCsaWdX.js";function Q(){const[,d]=k(),{toast:a}=E(),[m,r]=s.useState(!1),[o,g]=s.useState(!1),[n,N]=s.useState(!1),[x,v]=s.useState(""),[h,y]=s.useState(""),[i,w]=s.useState(""),[p,C]=s.useState(""),P=async t=>{if(t.preventDefault(),r(!0),i!==p){a({variant:"destructive",title:"خطأ",description:"كلمات المرور غير متطابقة"}),r(!1);return}if(i.length<4){a({variant:"destructive",title:"خطأ",description:"كلمة المرور يجب أن تكون على الأقل 4 أحرف"}),r(!1);return}try{const S=await(await B("POST","/api/employees/activate",{phone:x,fullName:h,password:i})).json();localStorage.setItem("currentEmployee",JSON.stringify(S)),a({title:"تم التفعيل بنجاح",description:"مرحباً بك! تم تفعيل حسابك بنجاح"}),d("/employee/dashboard")}catch(u){a({variant:"destructive",title:"فشل التفعيل",description:u.message||"حدث خطأ أثناء تفعيل الحساب. تأكد من رقم الهاتف والاسم."})}finally{r(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-primary/5 to-background flex items-center justify-center p-4",children:e.jsxs(L,{className:"w-full max-w-md bg-gradient-to-br from-background to-background border-primary/20",children:[e.jsxs(q,{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-amber-500 to-amber-700 rounded-full flex items-center justify-center",children:e.jsx(F,{className:"w-8 h-8 text-white"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx(I,{className:"text-2xl font-bold text-accent",children:"تفعيل حساب موظف جديد"}),e.jsx(O,{className:"text-gray-400 mt-2",children:"أدخل بياناتك التي سجلها المدير لإنشاء كلمة المرور الخاصةبك"})]})]}),e.jsx(T,{children:e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"fullName",className:"text-gray-300",children:"الاسم الكامل"}),e.jsx(c,{id:"fullName",value:h,onChange:t=>y(t.target.value),required:!0,placeholder:"أدخل اسمك الكامل كما سجله المدير",className:"bg-[#1a1410] border-primary/30 text-white placeholder:text-gray-500","data-testid":"input-fullname"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"يجب أن يطابق الاسم المسجل لدى المدير"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"phone",className:"text-gray-300",children:"رقم الهاتف"}),e.jsx(D,{id:"phone",value:x,onChange:t=>v(t),placeholder:"5xxxxxxxx","data-testid":"input-phone",required:!0}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"رقم الهاتف المسجل لدى المدير"})]}),e.jsxs("div",{className:"border-t border-primary/20 pt-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(l,{htmlFor:"password",className:"text-gray-300",children:"كلمة المرور الجديدة"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{id:"password",value:i,onChange:t=>w(t.target.value),type:o?"text":"password",required:!0,minLength:4,placeholder:"أدخل كلمة مرور قوية",className:"bg-[#1a1410] border-primary/30 text-white placeholder:text-gray-500 pl-10","data-testid":"input-password"}),e.jsx("button",{type:"button",onClick:()=>g(!o),className:"absolute left-3 top-3 text-accent hover:text-accent",children:o?e.jsx(j,{className:"h-4 w-4"}):e.jsx(b,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"confirmPassword",className:"text-gray-300",children:"تأكيد كلمة المرور"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{id:"confirmPassword",value:p,onChange:t=>C(t.target.value),type:n?"text":"password",required:!0,minLength:4,placeholder:"أعد إدخال كلمة المرور",className:"bg-[#1a1410] border-primary/30 text-white placeholder:text-gray-500 pl-10","data-testid":"input-confirm-password"}),e.jsx("button",{type:"button",onClick:()=>N(!n),className:"absolute left-3 top-3 text-accent hover:text-accent",children:n?e.jsx(j,{className:"h-4 w-4"}):e.jsx(b,{className:"h-4 w-4"})})]})]})]}),e.jsx("div",{className:"bg-background0/10 border border-primary/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(R,{className:"w-5 h-5 text-accent mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-accent/90",children:[e.jsx("p",{className:"font-semibold mb-1",children:"تعليمات مهمة:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"تأكد من إدخال رقم الهاتف والاسم المسجلين لدى المدير بدقة"}),e.jsx("li",{children:"اختر كلمة مرور قويةلا تقل عن 4 أحرف"}),e.jsx("li",{children:"احفظ كلمة المرور في مكان آمن"})]})]})]})}),e.jsx(f,{type:"submit",disabled:m,className:"w-full bg-gradient-to-r from-amber-500 to-amber-700 hover:from-amber-600 hover:to-amber-800 text-white","data-testid":"button-activate",children:m?"جاري التفعيل...":"تفعيل الحساب"}),e.jsx("div",{className:"text-center",children:e.jsx(f,{type:"button",variant:"ghost",onClick:()=>d("/employee/login"),className:"text-accent hover:text-accent","data-testid":"button-back-to-login",children:"العودةإلى تسجيل الدخول"})})]})})]})})}export{Q as default};
