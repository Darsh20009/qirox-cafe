import{j as e}from"./vendor-ui-DJm-zmnP.js";import{r as y}from"./vendor-react-Bzsngnqy.js";import{l as f,c as N,e as C,B as A,A as q,aa as E,ab as M,ac as n,C as S,f as I,j as $,i as g,_ as L,S as Q,ad as T,N as i}from"./index-CLvpp2UE.js";import{a as D,b as K}from"./vendor-query-CX8ZYlKb.js";import{S as B}from"./switch-C9eC4DLi.js";import{P as F}from"./package-B_dGuXgn.js";import{W as P}from"./wrench-C4Y35z7Q.js";import{D as c}from"./droplet-DmibwVCE.js";import"./vendor-utils-BKCsaWdX.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l=f("Cherry",[["path",{d:"M2 17a5 5 0 0 0 10 0c0-2.76-2.5-5-5-3-2.5-2-5 .24-5 3Z",key:"cvxqlc"}],["path",{d:"M12 17a5 5 0 0 0 10 0c0-2.76-2.5-5-5-3-2.5-2-5 .24-5 3Z",key:"1ostrc"}],["path",{d:"M7 14c3.22-2.91 4.29-8.75 5-12 1.66 2.38 4.94 9 5 12",key:"hqx58h"}],["path",{d:"M22 9c-4.29 0-7.14-2.33-10-7 5.71 0 10 4.67 10 7Z",key:"eykp1o"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p=f("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),Z=(o,d)=>d==="packaging"?F:d==="equipment"?P:d==="consumable"?L:{حليب:c,"حبوب البن":g,"بن مطحون":g,شوكولاتة:l,"حليب مكثف":c,فانيليا:Q,كاكاو:l,كراميل:c,ثلج:T,ماء:c,شاي:p,نعناع:p,ليمون:l,ماتشا:p,كيك:l,كريمة:c,بسكويت:l}[o]||g,J={ingredient:"المكونات",packaging:"التغليف",consumable:"المستهلكات",equipment:"المعدات",other:"أخرى"};function X(){const[,o]=N(),[d,u]=y.useState(null),[s,j]=y.useState("ingredient"),{toast:b}=C();y.useEffect(()=>{const a=localStorage.getItem("currentEmployee");a?u(JSON.parse(a)):o("/employee/gateway")},[o]);const{data:x=[],isLoading:h}=D({queryKey:["/api/employee/raw-items/by-category",s],queryFn:async()=>{const a=await fetch(`/api/employee/raw-items/by-category/${s}`,{credentials:"include"});if(!a.ok)throw new Error("Failed to fetch items");return a.json()}}),v=K({mutationFn:async({id:a,isActive:r})=>{const t=await fetch(`/api/employee/raw-items/${a}/availability`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({isActive:r})});if(!t.ok)throw new Error("Failed to update item");return t.json()},onMutate:async({id:a,isActive:r})=>{await i.cancelQueries({queryKey:["/api/employee/raw-items/by-category",s]});const t=i.getQueryData(["/api/employee/raw-items/by-category",s]);return i.setQueryData(["/api/employee/raw-items/by-category",s],w=>w?.map(m=>m.id===a?{...m,isActive:r}:m)),{previousItems:t}},onSuccess:()=>{i.invalidateQueries({queryKey:["/api/employee/raw-items/by-category",s]}),i.invalidateQueries({queryKey:["/api/inventory/raw-items"]}),i.invalidateQueries({queryKey:["/api/coffee-items"]}),b({title:"تم التحديث بنجاح",description:"تم تحديث حالة توفر المادة"})},onError:(a,r,t)=>{t?.previousItems&&i.setQueryData(["/api/employee/raw-items/by-category",s],t.previousItems),b({title:"خطأ",description:"فشل تحديث حالة توفر المادة",variant:"destructive"})}}),k=a=>{const r=a.isActive===1?0:1;v.mutate({id:a.id,isActive:r})};return d?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-amber-50 via-primary/5 to-yellow-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-amber-600 to-orange-600 text-white p-6 shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"إدارة المواد الخام"}),e.jsxs("p",{className:"text-accent",children:["مرحباً، ",d.fullName]})]}),e.jsxs(A,{onClick:()=>o("/employee/menu"),variant:"secondary",size:"lg",className:"gap-2","data-testid":"button-back-to-menu",children:[e.jsx(q,{className:"w-5 h-5"}),"العودة للقائمة"]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 border-r-4 border-primary",children:e.jsxs("p",{className:"text-gray-700 dark:text-gray-300",children:[e.jsx("strong",{children:"تنبيه:"})," عند تعطيل أي مادة، سيتم تلقائياً التأثير على جميع المشروبات التي تحتوي على هذه المادة في وصفاتها."]})})}),e.jsx(E,{value:s,onValueChange:j,className:"mb-6",children:e.jsxs(M,{className:"grid grid-cols-3 lg:grid-cols-5 gap-2 h-auto p-2 bg-white dark:bg-gray-800",children:[e.jsx(n,{value:"ingredient",className:"data-[state=active]:bg-background0 data-[state=active]:text-white","data-testid":"tab-ingredient",children:"المكونات"}),e.jsx(n,{value:"packaging",className:"data-[state=active]:bg-background0 data-[state=active]:text-white","data-testid":"tab-packaging",children:"التغليف"}),e.jsx(n,{value:"consumable",className:"data-[state=active]:bg-background0 data-[state=active]:text-white","data-testid":"tab-consumable",children:"المستهلكات"}),e.jsx(n,{value:"equipment",className:"data-[state=active]:bg-background0 data-[state=active]:text-white","data-testid":"tab-equipment",children:"المعدات"}),e.jsx(n,{value:"other",className:"data-[state=active]:bg-background0 data-[state=active]:text-white","data-testid":"tab-other",children:"أخرى"})]})}),h?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[...Array(8)].map((a,r)=>e.jsx("div",{className:"h-48 bg-gray-200 dark:bg-gray-700 rounded-xl animate-pulse"},r))}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:x.map(a=>{const r=Z(a.nameAr,a.category),t=a.isActive===1;return e.jsxs(S,{className:`group relative overflow-visible transition-all duration-300 ${t?"bg-white dark:bg-gray-800 border-2 border-primary dark:border-primary":"bg-gray-100 dark:bg-gray-900 border-2 border-gray-300 dark:border-gray-700 opacity-75"}`,"data-testid":`card-raw-item-${a.id}`,children:[e.jsx("div",{className:`absolute inset-0 rounded-lg bg-gradient-to-br ${t?"from-amber-50 to-background dark:from-amber-950/20 dark:to-orange-950/20":"from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800"} opacity-50`}),e.jsxs(I,{className:"relative p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-4",children:[e.jsx("div",{className:`p-3 rounded-full ${t?"bg-gradient-to-br from-amber-400 to-background0":"bg-gray-400"} shadow-lg`,children:e.jsx(r,{className:"w-6 h-6 text-white"})}),e.jsx($,{variant:t?"default":"secondary",className:`${t?"bg-green-500":"bg-red-500"} text-white`,"data-testid":`badge-status-${a.id}`,children:t?"متوفر":"غير متوفر"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-foreground mb-1","data-testid":`text-name-${a.id}`,children:a.nameAr}),a.nameEn&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-muted-foreground",children:a.nameEn}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:a.code})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"الحالة"}),e.jsx(B,{checked:t,onCheckedChange:()=>k(a),disabled:v.isPending,className:"data-[state=checked]:bg-green-500","data-testid":`switch-availability-${a.id}`})]})]})]},a.id)})}),!h&&x.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block p-6 bg-white dark:bg-gray-800 rounded-full shadow-lg mb-4",children:e.jsx(g,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"لا توجد مواد في هذه الفئة"}),e.jsxs("p",{className:"text-gray-500 dark:text-muted-foreground",children:["لم يتم إضافة أي مواد خام في فئة ",J[s]," بعد"]})]})]})]}):null}export{X as default};
