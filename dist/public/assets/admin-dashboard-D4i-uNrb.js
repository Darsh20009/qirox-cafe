import{j as e}from"./vendor-ui-DJm-zmnP.js";import{r as h}from"./vendor-react-Bzsngnqy.js";import{c as v,B as n,C as o,x as u,y as g,W as w,f as m}from"./index-61RjstaY.js";import{a as f}from"./vendor-query-CX8ZYlKb.js";import{S as k}from"./settings-CgStpNg9.js";import{U as j}from"./users-Btf_-tK9.js";import{A as C}from"./activity-D65WL5FX.js";import{C as b}from"./calendar-Cex3TfGh.js";import{D as E}from"./dollar-sign-B-fnJpJ6.js";import{T as N}from"./trending-up-CK4Nk2TF.js";import"./vendor-utils-BKCsaWdX.js";function V(){const[,l]=v(),[t,y]=h.useState({totalEmployees:0,activeEmployees:0,presentToday:0,onLeave:0,totalOrders:0,revenue:0,avgOrderValue:0});h.useEffect(()=>{document.title="لوحة تحكم الإدارة - CLUNY CAFE | إحصائيات شاملة";const s=document.querySelector('meta[name="description"]');s&&s.setAttribute("content","لوحة تحكم الإدارة في CLUNY CAFE - إحصائيات المبيعات والموظفين والطلبات")},[]);const{data:a}=f({queryKey:["/api/employees"],queryFn:async()=>{const s=await fetch("/api/employees");if(!s.ok)throw new Error("Failed to fetch employees");return s.json()}}),{data:d}=f({queryKey:["/api/orders"],queryFn:async()=>{const s=await fetch("/api/orders");if(!s.ok)throw new Error("Failed to fetch orders");return s.json()}});h.useEffect(()=>{if(a){const s=a.filter(r=>r.isActivated===1).length,i=d?.reduce((r,p)=>r+(p.totalAmount||0),0)||0,x=d?.length>0?i/d.length:0;y({totalEmployees:a.length,activeEmployees:s,presentToday:Math.floor(s*.8),onLeave:Math.floor(s*.1),totalOrders:d?.length||0,revenue:i,avgOrderValue:x})}},[a,d]);const c=({icon:s,label:i,value:x,subtext:r,color:p="primary"})=>e.jsx(o,{className:"border-border/50 bg-gradient-to-br from-card to-card/90 shadow-md hover:shadow-lg transition-all",children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:i}),e.jsx("p",{className:"text-3xl font-bold font-playfair mt-2 text-foreground",children:x}),r&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r})]}),e.jsx("div",{className:"bg-accent/20 dark:bg-accent/10 p-3 rounded-lg flex-shrink-0",children:e.jsx(s,{className:"w-6 h-6 text-accent"})})]})})});return e.jsxs("div",{className:"p-6 space-y-8 bg-gradient-to-b from-background via-primary/5 to-background min-h-screen",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold font-playfair text-foreground",children:"لوحة التحكم"}),e.jsx("p",{className:"text-muted-foreground mt-2 font-cairo",children:"مرحباً بك في نظام الإدارة"})]}),e.jsxs(n,{variant:"outline",onClick:()=>l("/admin/settings"),children:[e.jsx(k,{className:"w-4 h-4 ml-2"}),"الإعدادات"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(c,{icon:j,label:"إجمالي الموظفين",value:t.totalEmployees,subtext:`${t.activeEmployees} نشطين`}),e.jsx(c,{icon:C,label:"الحاضرون اليوم",value:t.presentToday,subtext:`من ${t.activeEmployees} موظف`}),e.jsx(c,{icon:b,label:"في الإجازة",value:t.onLeave,subtext:"موظفين الآن"}),e.jsx(c,{icon:E,label:"الإيرادات اليومية",value:`${t.revenue.toFixed(0)} ر.س`,subtext:`متوسط الطلب: ${t.avgOrderValue.toFixed(2)}`})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(o,{className:"lg:col-span-2 border-0 bg-white dark:bg-card",children:[e.jsxs(u,{className:"pb-4",children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5"}),"نظرة عامة على الطلبات"]}),e.jsx(w,{children:"آخر 7 أيام"})]}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 bg-background dark:bg-accent/20 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"إجمالي الطلبات"}),e.jsx("span",{className:"text-2xl font-bold text-accent dark:text-accent",children:t.totalOrders})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"الإيرادات الكلية"}),e.jsxs("span",{className:"text-2xl font-bold text-emerald-600 dark:text-emerald-400",children:[t.revenue.toFixed(0)," ر.س"]})]})]})})]}),e.jsxs(o,{className:"border-0 bg-white dark:bg-card",children:[e.jsx(u,{className:"pb-4",children:e.jsx(g,{children:"إجراءات سريعة"})}),e.jsxs(m,{className:"space-y-3",children:[e.jsxs(n,{onClick:()=>l("/admin/employees"),className:"w-full bg-accent hover:bg-accent text-white","data-testid":"button-manage-employees",children:[e.jsx(j,{className:"w-4 h-4 ml-2"}),"إدارة الموظفين"]}),e.jsxs(n,{variant:"outline",onClick:()=>l("/admin/attendance"),className:"w-full","data-testid":"button-view-attendance",children:[e.jsx(b,{className:"w-4 h-4 ml-2"}),"الحضور والغياب"]}),e.jsxs(n,{variant:"outline",onClick:()=>l("/admin/reports"),className:"w-full","data-testid":"button-view-reports",children:[e.jsx(N,{className:"w-4 h-4 ml-2"}),"التقارير"]})]})]})]}),e.jsxs(o,{className:"border-0 bg-white dark:bg-card",children:[e.jsx(u,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{children:"الموظفون الأخيرون"}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>l("/admin/employees"),"data-testid":"button-view-all-employees",children:"عرض الكل"})]})}),e.jsx(m,{children:a&&a.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-orange-200 dark:border-orange-900/30",children:[e.jsx("th",{className:"text-right p-3 font-semibold",children:"الاسم"}),e.jsx("th",{className:"text-right p-3 font-semibold",children:"الدور"}),e.jsx("th",{className:"text-right p-3 font-semibold",children:"الحالة"})]})}),e.jsx("tbody",{children:a.slice(0,5).map(s=>e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[e.jsx("td",{className:"p-3",children:s.fullName}),e.jsx("td",{className:"p-3 text-muted-foreground",children:s.jobTitle}),e.jsx("td",{className:"p-3",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${s.isActivated===1?"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-400":"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-muted-foreground"}`,children:s.isActivated===1?"نشط":"معطل"})})]},s.id))})]})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(j,{className:"w-12 h-12 mx-auto text-gray-300 mb-3"}),e.jsx("p",{className:"text-muted-foreground",children:"لا توجد موظفون"})]})})]})]})}export{V as default};
