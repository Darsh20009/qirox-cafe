import{j as e}from"./vendor-ui-DJm-zmnP.js";import{r as o}from"./vendor-react-Bzsngnqy.js";import{c as g,R as j,C as b,x as N,y as w,W as y,f as v,U as C,I as x,B as c,q as S}from"./index-61RjstaY.js";import{b as E}from"./vendor-query-CX8ZYlKb.js";import{L as k}from"./lock-DEIb_4Mx.js";import{E as L}from"./eye-off-D4nLDnly.js";import{E as P}from"./eye-A6WRE6cq.js";import"./vendor-utils-BKCsaWdX.js";function D(){const[,a]=g(),[n,p]=o.useState(""),[i,l]=o.useState(""),[d,f]=o.useState(!1),[m,r]=o.useState(""),s=E({mutationFn:async t=>{const u=await fetch("/api/employees/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"});if(!u.ok)throw new Error("Login failed");return u.json()},onSuccess:t=>{if(t.role!=="manager"&&t.role!=="admin"){r("هذا الحساب ليس حساب مدير"),l("");return}localStorage.setItem("currentEmployee",JSON.stringify(t)),a("/manager/dashboard")},onError:()=>{r("اسم المستخدم أو كلمة المرور غير صحيحة "),l("")}}),h=t=>{if(t.preventDefault(),r(""),!n||!i){r("الرجاء إدخال اسم المستخدم وكلمة المرور");return}s.mutate({username:n,password:i})};return e.jsx("div",{dir:"rtl",className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-40 h-28 mb-4",children:e.jsx("img",{src:j,alt:"CLUNY SYSTEMS",className:"w-full h-full object-contain"})}),e.jsx("h1",{className:"text-3xl font-bold font-playfair text-foreground mb-2",children:"CLUNY CAFE"}),e.jsx("p",{className:"text-muted-foreground font-cairo",children:"تسجيل دخول المدير"})]}),e.jsxs(b,{className:"bg-card border-border/50 shadow-lg",children:[e.jsxs(N,{children:[e.jsx(w,{className:"text-2xl text-center font-playfair text-foreground",children:"لوحة تحكم المدير"}),e.jsx(y,{className:"text-center text-muted-foreground",children:"أدخل بيانات حساب المدير للوصول"})]}),e.jsx(v,{children:e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute right-3 top-3 h-5 w-5 text-muted-foreground"}),e.jsx(x,{type:"text",placeholder:"اسم المستخدم",value:n,onChange:t=>p(t.target.value),className:"pr-10","data-testid":"input-username",autoComplete:"username",autoFocus:!0,disabled:s.isPending})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute right-3 top-3 h-5 w-5 text-muted-foreground"}),e.jsx(x,{type:d?"text":"password",placeholder:"كلمة المرور",value:i,onChange:t=>l(t.target.value),className:"pr-10 pl-10","data-testid":"input-password",autoComplete:"current-password",disabled:s.isPending}),e.jsx("button",{type:"button",onClick:()=>f(!d),className:"absolute left-3 top-3 text-muted-foreground hover:text-foreground","data-testid":"button-toggle-password",children:d?e.jsx(L,{className:"h-5 w-5"}):e.jsx(P,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:()=>a("/manager/forgot-password"),className:"text-xs text-primary hover:text-primary/80 underline","data-testid":"link-forgot-password",children:"نسيت كلمة المرور؟"})}),m&&e.jsx("p",{className:"text-destructive text-sm text-right","data-testid":"text-error",children:m})]}),e.jsx(c,{type:"submit",disabled:s.isPending,className:"w-full bg-gradient-to-r from-accent to-accent/90 hover:from-accent/95 hover:to-accent/85 text-accent-foreground font-semibold","data-testid":"button-login",children:s.isPending?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"ml-2 h-4 w-4 animate-spin"}),"جاري تسجيل الدخول..."]}):"دخول"}),e.jsxs("div",{className:"pt-4 border-t border-border",children:[e.jsx("p",{className:"text-sm text-muted-foreground text-center mb-2",children:"موظف عادي؟"}),e.jsx(c,{type:"button",variant:"outline",onClick:()=>a("/employee/login"),className:"w-full","data-testid":"button-employee-login",children:"تسجيل دخول الموظف"})]})]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(c,{variant:"ghost",onClick:()=>a("/"),"data-testid":"link-back",children:"رجوع"})})]})})}export{D as default};
