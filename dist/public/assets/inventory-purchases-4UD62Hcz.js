import{j as e}from"./vendor-ui-DJm-zmnP.js";import{r as x}from"./vendor-react-Bzsngnqy.js";import{a as q,b as T}from"./vendor-query-CX8ZYlKb.js";import{e as Pe,q as U,B as r,P as ue,C as b,x as w,y as k,f as C,X as qe,I as p,j as K,a0 as J,D as X,E as _,F as G,H as W,L as c,$ as Te,K as Y,J as ke,v as O,N as g}from"./index-CLvpp2UE.js";import{P as Ke}from"./progress-DVPXITZU.js";import{S as M,a as V,b as E,c as Q,d as A}from"./select-BzAjeBJu.js";import{T as Z,a as ee,b as j,c as l,d as se,e as i}from"./table-DVDQb40v.js";import{F as he}from"./file-text-QZcL_gux.js";import{R as Oe}from"./receipt-7jFYni-X.js";import{D as Me}from"./dollar-sign-CFWcU9O3.js";import{P as je}from"./package-B_dGuXgn.js";import{C as Ve}from"./circle-alert-CfteRpPO.js";import{f as pe}from"./vendor-utils-BKCsaWdX.js";import{E as Ee}from"./eye-cZNGFzyE.js";import{a as ge}from"./ar-CeWsqWSX.js";import"./chevron-down-CqdH-ack.js";const I={draft:{label:"مسودة",variant:"secondary"},pending:{label:"قيد الانتظار",variant:"outline"},approved:{label:"معتمدة",variant:"default"},received:{label:"تم الاستلام",variant:"default"},cancelled:{label:"ملغاة",variant:"destructive"}},$={unpaid:{label:"غير مدفوعة",variant:"destructive"},partial:{label:"مدفوعة جزئياً",variant:"secondary"},paid:{label:"مدفوعة",variant:"default"}};function ss(){const{toast:o}=Pe(),[te,fe]=x.useState(""),[L,ve]=x.useState("all"),[ye,S]=x.useState(!1),[Ne,F]=x.useState(!1),[be,D]=x.useState(!1),[t,ae]=x.useState(null),[f,v]=x.useState(0),[n,u]=x.useState({supplierId:"",branchId:"",items:[],taxAmount:0,discountAmount:0,notes:"",dueDate:""}),[d,y]=x.useState({rawItemId:"",quantity:1,unitCost:0}),{data:h=[],isLoading:we}=q({queryKey:["/api/inventory/purchases"]}),{data:P=[]}=q({queryKey:["/api/inventory/raw-items"]}),{data:ne=[]}=q({queryKey:["/api/inventory/suppliers"]}),{data:ie=[]}=q({queryKey:["/api/branches"]}),R=T({mutationFn:s=>O("POST","/api/inventory/purchases",s),onSuccess:()=>{g.invalidateQueries({queryKey:["/api/inventory/purchases"]}),S(!1),Ce(),o({title:"تم إنشاء فاتورة الشراء بنجاح"})},onError:s=>{o({title:s.message||"فشل في إنشاء فاتورة الشراء",variant:"destructive"})}}),le=T({mutationFn:s=>O("PUT",`/api/inventory/purchases/${s}/receive`),onSuccess:()=>{g.invalidateQueries({queryKey:["/api/inventory/purchases"]}),g.invalidateQueries({queryKey:["/api/inventory/stock"]}),g.invalidateQueries({queryKey:["/api/accounting/journal-entries"]}),o({title:"تم استلام الفاتورة وتحديث المخزون والقيود المحاسبية"})},onError:s=>{o({title:s.message||"فشل في استلام الفاتورة",variant:"destructive"})}}),z=T({mutationFn:s=>O("PUT",`/api/inventory/purchases/${s.id}/payment`,{amount:s.amount}),onSuccess:()=>{g.invalidateQueries({queryKey:["/api/inventory/purchases"]}),D(!1),v(0),o({title:"تم تسجيل الدفعة بنجاح"})},onError:s=>{o({title:s.message||"فشل في تسجيل الدفعة",variant:"destructive"})}}),re=T({mutationFn:s=>O("PUT",`/api/inventory/purchases/${s}/approve`),onSuccess:()=>{g.invalidateQueries({queryKey:["/api/inventory/purchases"]}),o({title:"تم اعتماد الفاتورة بنجاح"})},onError:s=>{o({title:s.message||"فشل في اعتماد الفاتورة",variant:"destructive"})}}),Ce=()=>{u({supplierId:"",branchId:"",items:[],taxAmount:0,discountAmount:0,notes:"",dueDate:""}),y({rawItemId:"",quantity:1,unitCost:0})},Ae=()=>{if(!d.rawItemId||d.quantity<=0)return;const s=P.find(H=>H.id===d.rawItemId),a=d.unitCost||s?.unitCost||0,m=d.quantity*a;u({...n,items:[...n.items,{rawItemId:d.rawItemId,quantity:d.quantity,unitCost:a,totalCost:m}]}),y({rawItemId:"",quantity:1,unitCost:0})},Ie=s=>{u({...n,items:n.items.filter((a,m)=>m!==s)})},B=()=>{const s=n.items.reduce((m,H)=>m+H.totalCost,0),a=s+n.taxAmount-n.discountAmount;return{subtotal:s,totalAmount:a}},Se=()=>{if(!n.supplierId||!n.branchId||n.items.length===0){o({title:"يرجى ملء جميع الحقول المطلوبة",variant:"destructive"});return}const{subtotal:s,totalAmount:a}=B();R.mutate({...n,subtotal:Number(s)||0,taxAmount:Number(n.taxAmount)||0,discountAmount:Number(n.discountAmount)||0,totalAmount:Number(a)||0})},Fe=s=>{ae(s),F(!0)},de=s=>{ae(s),v(s.totalAmount-s.paidAmount),D(!0)},De=()=>{t&&f>0&&z.mutate({id:t.id,amount:f})},N={totalPurchases:h.length,totalValue:h.reduce((s,a)=>s+a.totalAmount,0),pendingPayment:h.filter(s=>s.paymentStatus!=="paid").reduce((s,a)=>s+(a.totalAmount-a.paidAmount),0),receivedCount:h.filter(s=>s.status==="received").length,pendingReceive:h.filter(s=>s.status==="approved").length,overdueCount:h.filter(s=>s.dueDate&&new Date(s.dueDate)<new Date&&s.paymentStatus!=="paid").length},ce=h.filter(s=>{const a=s.invoiceNumber.toLowerCase().includes(te.toLowerCase()),m=L==="all"||s.status===L;return a&&m}),oe=s=>P.find(a=>a.id===s)?.nameAr||s,me=s=>ne.find(a=>a.id===s)?.nameAr||s,xe=s=>ie.find(a=>a.id===s)?.nameAr||s;return we?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(U,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"p-6 space-y-6",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(he,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"فواتير الشراء"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"إدارة فواتير شراء المواد الخام"})]})]}),e.jsxs(r,{onClick:()=>S(!0),"data-testid":"button-add-purchase",children:[e.jsx(ue,{className:"h-4 w-4 ml-2"}),"إنشاء فاتورة"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(b,{children:[e.jsxs(w,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"إجمالي المشتريات"}),e.jsx(Oe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(C,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[N.totalValue.toFixed(2)," ر.س"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[N.totalPurchases," فاتورة"]})]})]}),e.jsxs(b,{children:[e.jsxs(w,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"المستحقات"}),e.jsx(Me,{className:"h-4 w-4 text-destructive"})]}),e.jsxs(C,{children:[e.jsxs("div",{className:"text-2xl font-bold text-destructive",children:[N.pendingPayment.toFixed(2)," ر.س"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"مبالغ غير مسددة"})]})]}),e.jsxs(b,{children:[e.jsxs(w,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"في انتظار الاستلام"}),e.jsx(je,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(C,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:N.pendingReceive}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"فاتورة معتمدة"})]})]}),e.jsxs(b,{children:[e.jsxs(w,{className:"flex flex-row items-center justify-between gap-2 space-y-0 pb-2",children:[e.jsx(k,{className:"text-sm font-medium",children:"متأخرة السداد"}),e.jsx(Ve,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(C,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:N.overdueCount}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"فاتورة متأخرة"})]})]})]}),e.jsxs(b,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(qe,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(p,{placeholder:"بحث برقم الفاتورة...",value:te,onChange:s=>fe(s.target.value),className:"pr-10","data-testid":"input-search-purchases"})]}),e.jsxs(M,{value:L,onValueChange:ve,children:[e.jsx(V,{className:"w-[180px]","data-testid":"select-status-filter",children:e.jsx(E,{placeholder:"الحالة"})}),e.jsxs(Q,{children:[e.jsx(A,{value:"all",children:"جميع الحالات"}),Object.entries(I).map(([s,{label:a}])=>e.jsx(A,{value:s,children:a},s))]})]})]})}),e.jsx(C,{children:e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(j,{className:"bg-muted/50",children:[e.jsx(l,{className:"text-right",children:"رقم الفاتورة"}),e.jsx(l,{className:"text-right",children:"المورد"}),e.jsx(l,{className:"text-right",children:"الفرع"}),e.jsx(l,{className:"text-right",children:"المبلغ"}),e.jsx(l,{className:"text-right",children:"الحالة"}),e.jsx(l,{className:"text-right",children:"حالة الدفع"}),e.jsx(l,{className:"text-right",children:"التاريخ"}),e.jsx(l,{className:"text-right",children:"الإجراءات"})]})}),e.jsx(se,{children:ce.length===0?e.jsx(j,{children:e.jsx(i,{colSpan:8,className:"text-center py-8 text-muted-foreground",children:"لا توجد فواتير شراء"})}):ce.map(s=>e.jsxs(j,{"data-testid":`row-purchase-${s.id}`,children:[e.jsx(i,{className:"font-mono",children:s.invoiceNumber}),e.jsx(i,{children:me(s.supplierId)}),e.jsx(i,{children:xe(s.branchId)}),e.jsxs(i,{children:[s.totalAmount.toFixed(2)," ر.س"]}),e.jsx(i,{children:e.jsx(K,{variant:I[s.status]?.variant||"secondary",children:I[s.status]?.label||s.status})}),e.jsx(i,{children:e.jsx(K,{variant:$[s.paymentStatus]?.variant||"secondary",children:$[s.paymentStatus]?.label||s.paymentStatus})}),e.jsx(i,{children:pe(new Date(s.invoiceDate),"dd/MM/yyyy",{locale:ge})}),e.jsx(i,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(r,{size:"icon",variant:"ghost",onClick:()=>Fe(s),"data-testid":`button-view-${s.id}`,children:e.jsx(Ee,{className:"h-4 w-4"})}),s.status==="draft"&&e.jsx(r,{size:"icon",variant:"ghost",onClick:()=>re.mutate(s.id),disabled:re.isPending,"data-testid":`button-approve-${s.id}`,title:"اعتماد الفاتورة",children:e.jsx(he,{className:"h-4 w-4 text-blue-600"})}),s.status==="approved"&&e.jsx(r,{size:"icon",variant:"ghost",onClick:()=>le.mutate(s.id),disabled:le.isPending,"data-testid":`button-receive-${s.id}`,title:"استلام البضاعة",children:e.jsx(je,{className:"h-4 w-4 text-green-600"})}),s.paymentStatus!=="paid"&&e.jsx(r,{size:"icon",variant:"ghost",onClick:()=>de(s),"data-testid":`button-payment-${s.id}`,title:"تسجيل دفعة",children:e.jsx(J,{className:"h-4 w-4 text-primary"})})]})})]},s.id))})]})})})]}),e.jsx(X,{open:ye,onOpenChange:S,children:e.jsxs(_,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",dir:"rtl",children:[e.jsx(G,{children:e.jsx(W,{children:"إنشاء فاتورة شراء جديدة"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"المورد *"}),e.jsxs(M,{value:n.supplierId,onValueChange:s=>u({...n,supplierId:s}),children:[e.jsx(V,{"data-testid":"select-supplier",children:e.jsx(E,{placeholder:"اختر المورد"})}),e.jsx(Q,{children:ne.map(s=>e.jsx(A,{value:s.id,children:s.nameAr},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"الفرع *"}),e.jsxs(M,{value:n.branchId,onValueChange:s=>u({...n,branchId:s}),children:[e.jsx(V,{"data-testid":"select-branch",children:e.jsx(E,{placeholder:"اختر الفرع"})}),e.jsx(Q,{children:ie.map(s=>e.jsx(A,{value:s.id,children:s.nameAr},s.id))})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"المواد"}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsxs(M,{value:d.rawItemId,onValueChange:s=>{const a=P.find(m=>m.id===s);y({...d,rawItemId:s,unitCost:a?.unitCost||0})},children:[e.jsx(V,{"data-testid":"select-raw-item",children:e.jsx(E,{placeholder:"اختر المادة"})}),e.jsx(Q,{children:P.map(s=>e.jsx(A,{value:s.id,children:s.nameAr},s.id))})]}),e.jsx(p,{type:"number",min:"1",placeholder:"الكمية",value:d.quantity,onChange:s=>y({...d,quantity:parseInt(s.target.value)||1}),"data-testid":"input-quantity"}),e.jsx(p,{type:"number",min:"0",step:"0.01",placeholder:"سعر الوحدة",value:d.unitCost,onChange:s=>y({...d,unitCost:parseFloat(s.target.value)||0}),"data-testid":"input-unit-cost"}),e.jsx(r,{onClick:Ae,"data-testid":"button-add-item",children:e.jsx(ue,{className:"h-4 w-4"})})]}),n.items.length>0&&e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(j,{className:"bg-muted/50",children:[e.jsx(l,{className:"text-right",children:"المادة"}),e.jsx(l,{className:"text-right",children:"الكمية"}),e.jsx(l,{className:"text-right",children:"سعر الوحدة"}),e.jsx(l,{className:"text-right",children:"الإجمالي"}),e.jsx(l,{className:"text-right"})]})}),e.jsx(se,{children:n.items.map((s,a)=>e.jsxs(j,{children:[e.jsx(i,{children:oe(s.rawItemId)}),e.jsx(i,{children:s.quantity}),e.jsxs(i,{children:[s.unitCost.toFixed(2)," ر.س"]}),e.jsxs(i,{children:[s.totalCost.toFixed(2)," ر.س"]}),e.jsx(i,{children:e.jsx(r,{size:"icon",variant:"ghost",onClick:()=>Ie(a),children:e.jsx(Te,{className:"h-4 w-4 text-destructive"})})})]},a))})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"الضريبة (ر.س)"}),e.jsx(p,{type:"number",min:"0",step:"0.01",value:n.taxAmount,onChange:s=>u({...n,taxAmount:parseFloat(s.target.value)||0}),"data-testid":"input-tax"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"الخصم (ر.س)"}),e.jsx(p,{type:"number",min:"0",step:"0.01",value:n.discountAmount,onChange:s=>u({...n,discountAmount:parseFloat(s.target.value)||0}),"data-testid":"input-discount"})]})]}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"المجموع الفرعي:"}),e.jsxs("span",{children:[B().subtotal.toFixed(2)," ر.س"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"الضريبة:"}),e.jsxs("span",{children:[n.taxAmount.toFixed(2)," ر.س"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"الخصم:"}),e.jsxs("span",{children:["-",n.discountAmount.toFixed(2)," ر.س"]})]}),e.jsxs("div",{className:"flex justify-between font-bold border-t pt-2 mt-2",children:[e.jsx("span",{children:"الإجمالي:"}),e.jsxs("span",{children:[B().totalAmount.toFixed(2)," ر.س"]})]})]})]}),e.jsxs(Y,{children:[e.jsx(r,{variant:"outline",onClick:()=>S(!1),children:"إلغاء"}),e.jsxs(r,{onClick:Se,disabled:R.isPending||!n.supplierId||!n.branchId||n.items.length===0,"data-testid":"button-submit",children:[R.isPending&&e.jsx(U,{className:"h-4 w-4 ml-2 animate-spin"}),"إنشاء الفاتورة"]})]})]})}),e.jsx(X,{open:Ne,onOpenChange:F,children:e.jsxs(_,{className:"max-w-2xl",dir:"rtl",children:[e.jsx(G,{children:e.jsx(W,{children:"تفاصيل الفاتورة"})}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-muted-foreground",children:"رقم الفاتورة"}),e.jsx("p",{className:"font-mono font-medium",children:t.invoiceNumber})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-muted-foreground",children:"التاريخ"}),e.jsx("p",{children:pe(new Date(t.invoiceDate),"dd/MM/yyyy",{locale:ge})})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-muted-foreground",children:"المورد"}),e.jsx("p",{children:me(t.supplierId)})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-muted-foreground",children:"الفرع"}),e.jsx("p",{children:xe(t.branchId)})]})]}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(j,{className:"bg-muted/50",children:[e.jsx(l,{className:"text-right",children:"المادة"}),e.jsx(l,{className:"text-right",children:"الكمية"}),e.jsx(l,{className:"text-right",children:"سعر الوحدة"}),e.jsx(l,{className:"text-right",children:"الإجمالي"})]})}),e.jsx(se,{children:t.items.map((s,a)=>e.jsxs(j,{children:[e.jsx(i,{children:oe(s.rawItemId)}),e.jsx(i,{children:s.quantity}),e.jsxs(i,{children:[s.unitCost.toFixed(2)," ر.س"]}),e.jsxs(i,{children:[s.totalCost.toFixed(2)," ر.س"]})]},a))})]})}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"المجموع الفرعي:"}),e.jsxs("span",{children:[t.subtotal.toFixed(2)," ر.س"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"الضريبة:"}),e.jsxs("span",{children:[t.taxAmount.toFixed(2)," ر.س"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"الخصم:"}),e.jsxs("span",{children:["-",t.discountAmount.toFixed(2)," ر.س"]})]}),e.jsxs("div",{className:"flex justify-between font-bold border-t pt-2 mt-2",children:[e.jsx("span",{children:"الإجمالي:"}),e.jsxs("span",{children:[t.totalAmount.toFixed(2)," ر.س"]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-muted-foreground",children:"الحالة"}),e.jsx(K,{variant:I[t.status]?.variant||"secondary",children:I[t.status]?.label||t.status})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-muted-foreground",children:"حالة الدفع"}),e.jsx(K,{variant:$[t.paymentStatus]?.variant||"secondary",children:$[t.paymentStatus]?.label||t.paymentStatus})]})]}),e.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"المدفوع"}),e.jsxs("span",{className:"text-sm",children:[t.paidAmount.toFixed(2)," من ",t.totalAmount.toFixed(2)," ر.س"]})]}),e.jsx(Ke,{value:t.paidAmount/t.totalAmount*100,className:"h-2"}),e.jsxs("div",{className:"flex justify-between items-center gap-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["المتبقي: ",(t.totalAmount-t.paidAmount).toFixed(2)," ر.س"]}),e.jsxs("span",{children:[Math.round(t.paidAmount/t.totalAmount*100),"% مدفوع"]})]})]})]}),e.jsxs(Y,{className:"gap-2",children:[e.jsx(r,{variant:"outline",onClick:()=>F(!1),children:"إغلاق"}),t&&t.paymentStatus!=="paid"&&e.jsxs(r,{onClick:()=>{F(!1),de(t)},children:[e.jsx(J,{className:"h-4 w-4 ml-2"}),"تسجيل دفعة"]})]})]})}),e.jsx(X,{open:be,onOpenChange:D,children:e.jsxs(_,{className:"max-w-md",dir:"rtl",children:[e.jsxs(G,{children:[e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5 text-primary"}),"تسجيل دفعة"]}),e.jsxs(ke,{children:["تسجيل دفعة جديدة للفاتورة ",t?.invoiceNumber]})]}),t&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"إجمالي الفاتورة:"}),e.jsxs("span",{className:"font-medium",children:[t.totalAmount.toFixed(2)," ر.س"]})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"المدفوع سابقاً:"}),e.jsxs("span",{className:"font-medium",children:[t.paidAmount.toFixed(2)," ر.س"]})]}),e.jsxs("div",{className:"flex justify-between gap-2 border-t pt-2",children:[e.jsx("span",{className:"font-medium",children:"المتبقي:"}),e.jsxs("span",{className:"font-bold text-destructive",children:[(t.totalAmount-t.paidAmount).toFixed(2)," ر.س"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"payment-amount",children:"مبلغ الدفعة *"}),e.jsx(p,{id:"payment-amount",type:"number",min:"0.01",max:t.totalAmount-t.paidAmount,step:"0.01",value:f,onChange:s=>v(parseFloat(s.target.value)||0),"data-testid":"input-payment-amount"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["الحد الأقصى: ",(t.totalAmount-t.paidAmount).toFixed(2)," ر.س"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>v((t.totalAmount-t.paidAmount)/2),children:"نصف المتبقي"}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>v(t.totalAmount-t.paidAmount),children:"كامل المتبقي"})]})]}),e.jsxs(Y,{children:[e.jsx(r,{variant:"outline",onClick:()=>D(!1),children:"إلغاء"}),e.jsxs(r,{onClick:De,disabled:z.isPending||f<=0||(t?f>t.totalAmount-t.paidAmount:!1),"data-testid":"button-submit-payment",children:[z.isPending&&e.jsx(U,{className:"h-4 w-4 ml-2 animate-spin"}),"تأكيد الدفع"]})]})]})})]})}export{ss as default};
