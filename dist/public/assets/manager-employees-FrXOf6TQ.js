import{j as e}from"./vendor-ui-DJm-zmnP.js";import{r as l}from"./vendor-react-Bzsngnqy.js";import{a as Z,b as W}from"./vendor-query-CX8ZYlKb.js";import{u as Ne,c as ve,e as we,i as Se,B as m,af as ke,D as Y,Z as Te,P as Pe,E as ee,F as ae,H as se,L as t,I as c,o as Ie,a9 as te,a2 as re,C as Ee,x as De,y as Ce,U as ie,f as Fe,j as Ue,p as Oe,r as Be,v as le,N as de}from"./index-61RjstaY.js";import{S as D,a as C,b as F,c as U,d}from"./select-BgcBxbEj.js";import{S as qe}from"./shield-Dc4uCcfL.js";import{S as Re}from"./square-pen-ixcF0lYC.js";import{P as Ve}from"./percent-gcOuF4JK.js";import"./vendor-utils-BKCsaWdX.js";import"./chevron-down-BsuQiE4E.js";function ea(){const{t:_,i18n:ne}=Ne(),[,p]=ve(),{toast:h}=we(),[ce,O]=l.useState(!1),[i,S]=l.useState(null),[u,$]=l.useState(null),[Ae,N]=l.useState(null),[B,v]=l.useState(null),[me,k]=l.useState(null),[Le,T]=l.useState(null),[q,P]=l.useState(null),[oe,R]=l.useState(null),K=l.useRef(null),z=l.useRef(null),[I,E]=l.useState(!1),[V,H]=l.useState("cashier"),[A,Q]=l.useState(""),[x,j]=l.useState([]),[g,b]=l.useState([]);l.useEffect(()=>{i?(j(i.permissions||[]),b(i.allowedPages||[])):(j([]),b([]))},[i]);const J=[{id:"create_order",label:"إنشاء طلبات"},{id:"cancel_order",label:"إلغاء طلبات"},{id:"manage_inventory",label:"إدارة المخزون"},{id:"view_reports",label:"عرض التقارير"},{id:"manage_employees",label:"إدارة الموظفين"},{id:"manage_branches",label:"إدارة الفروع"},{id:"manage_settings",label:"إعدادات النظام"}],G=[{id:"/employee/pos",label:"نقطة البيع"},{id:"/employee/orders",label:"الطلبات"},{id:"/employee/inventory",label:"المخزون"},{id:"/employee/accounting",label:"المحاسبة"},{id:"/employee/attendance",label:"التحضير"},{id:"/employee/availability",label:"التوفر"},{id:"/employee/cashier",label:"الكاشير"},{id:"/manager/dashboard",label:"لوحة التحكم"},{id:"/manager/employees",label:"إدارة الموظفين"}];l.useEffect(()=>{(async()=>{const s=localStorage.getItem("currentEmployee");if(s){const r=JSON.parse(s);try{const n=await fetch("/api/verify-session",{credentials:"include"});if(!n.ok){localStorage.removeItem("currentEmployee"),p("/employee/gateway");return}const o=await n.json();if(o&&o.employee){const y={...r,...o.employee};localStorage.setItem("currentEmployee",JSON.stringify(y)),$(y)}else $(r)}catch(n){console.error("Session verification error:",n),localStorage.removeItem("currentEmployee"),p("/employee/gateway")}}else p("/employee/gateway")})()},[p]);const f=u?.role==="admin"||u?.role==="owner",X=u?.branchId,{data:w=[],isLoading:he,isError:Me,error:_e}=Z({queryKey:["/api/employees"],enabled:!!u,retry:1}),xe=Z({queryKey:["/api/branches"],enabled:!!u&&f}).data||[];l.useMemo(()=>Array.isArray(w)?f?w:w.filter(a=>a&&a.branchId===X):[],[w,f,X]);const L=W({mutationFn:async a=>await(await le("POST","/api/employees",a)).json(),onSuccess:()=>{de.invalidateQueries({queryKey:["/api/employees"]}),O(!1),H("cashier"),Q(""),v(null),N(null),k(null),h({title:"تم إضافة الموظف",description:"تم إضافة الموظف بنجاح. يمكنه الآن إنشاء كلمة المرور الخاصةبه."})},onError:a=>{h({variant:"destructive",title:"فشل إضافة الموظف",description:a.message||"حدث خطأ أثناء إضافة الموظف"})}}),M=W({mutationFn:async({id:a,data:s})=>await(await le("PUT",`/api/employees/${a}`,s)).json(),onSuccess:()=>{de.invalidateQueries({queryKey:["/api/employees"]}),S(null),h({title:"تم تحديث الموظف",description:"تم تحديث بيانات الموظف بنجاح"})},onError:a=>{h({variant:"destructive",title:"فشل التحديث",description:a.message||"حدث خطأ أثناء تحديث الموظف"})}}),ge=()=>{localStorage.removeItem("currentEmployee"),p("/employee/gateway")},ue=a=>{a.preventDefault();const s=new FormData(a.currentTarget),r=s.get("username"),n=s.getAll("workDays"),o=s.get("shiftStartTime"),y=s.get("shiftEndTime"),fe=f&&A?A:u?.branchId,ye={username:r,fullName:s.get("fullName"),phone:s.get("phone"),jobTitle:s.get("jobTitle"),role:V,branchId:fe,permissions:x,allowedPages:g,shiftTime:o&&y?`${o}-${y}`:void 0,shiftStartTime:o||void 0,shiftEndTime:y||void 0,workDays:n.length>0?n:void 0,deviceBalance:parseInt(s.get("deviceBalance"))||0,commissionPercentage:parseFloat(s.get("commissionPercentage"))||0,imageUrl:me||void 0};L.mutate(ye)},pe=a=>{if(a.preventDefault(),!i)return;const s=new FormData(a.currentTarget),r=s.getAll("workDays"),n={fullName:s.get("fullName"),phone:s.get("phone"),jobTitle:s.get("jobTitle"),permissions:x,allowedPages:g,shiftTime:s.get("shiftTime"),shiftStartTime:s.get("shiftStartTime")||void 0,shiftEndTime:s.get("shiftEndTime")||void 0,workDays:r.length>0?r:void 0,deviceBalance:parseInt(s.get("deviceBalance"))||0,commissionPercentage:parseFloat(s.get("commissionPercentage"))||0,imageUrl:oe||i.imageUrl||void 0};M.mutate({id:i.id||"",data:n})},je=async a=>{if(!a)return;const s=URL.createObjectURL(a);v(s),N(a),E(!0);try{const r=new FormData;r.append("image",a);const n=await fetch("/api/upload-employee-image",{method:"POST",body:r,credentials:"include"});if(n.ok){const o=await n.json();k(o.url),h({title:"تم رفع الصورة",description:"تم رفع صورة الموظف بنجاح"})}else throw new Error("فشل الرفع")}catch{h({title:"خطأ",description:"فشل رفع الصورة",variant:"destructive"}),v(null),N(null)}E(!1)},be=async a=>{if(!a)return;const s=URL.createObjectURL(a);P(s),T(a),E(!0);try{const r=new FormData;r.append("image",a);const n=await fetch("/api/upload-employee-image",{method:"POST",body:r,credentials:"include"});if(n.ok){const o=await n.json();R(o.url),h({title:"تم رفع الصورة",description:"تم رفع صورة الموظف بنجاح"})}else throw new Error("فشل الرفع")}catch{h({title:"خطأ",description:"فشل رفع الصورة",variant:"destructive"}),P(null),T(null)}E(!1)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-primary/5 to-background p-4",dir:ne.language==="ar"?"rtl":"ltr",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-amber-500 to-amber-700 rounded-full flex items-center justify-center",children:e.jsx(Se,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-accent",children:_("manager.employees")}),e.jsx("p",{className:"text-gray-400 text-sm",children:_("manager.dashboard")})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{onClick:()=>p("/employee/dashboard"),variant:"outline",className:"border-primary/50 text-accent","data-testid":"button-dashboard",children:"لوحةالتحكم"}),e.jsxs(m,{variant:"outline",onClick:ge,className:"border-red-500/50 text-red-500 hover:bg-red-500 hover:text-white","data-testid":"button-logout",children:[e.jsx(ke,{className:"w-4 h-4 ml-2"}),"تسجيل الخروج"]})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs(Y,{open:ce,onOpenChange:O,children:[e.jsx(Te,{asChild:!0,children:e.jsxs(m,{className:"bg-gradient-to-r from-amber-500 to-amber-700 hover:from-amber-600 hover:to-amber-800","data-testid":"button-add-employee",children:[e.jsx(Pe,{className:"w-4 h-4 ml-2"}),"إضافة موظف جديد"]})}),e.jsxs(ee,{className:"bg-[#2d1f1a] border-primary/20 text-white w-full max-w-sm sm:max-w-md md:max-w-lg lg:max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ae,{children:e.jsx(se,{className:"text-accent",children:"إضافة موظف جديد"})}),e.jsxs("form",{onSubmit:ue,className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"fullName",className:"text-gray-300",children:"الاسم الكامل *"}),e.jsx(c,{id:"fullName",name:"fullName",required:!0,className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"input-fullname"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"username",className:"text-gray-300",children:"اسم المستخدم *"}),e.jsx(c,{id:"username",name:"username",required:!0,className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"input-username"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"phone",className:"text-gray-300",children:"رقم الهاتف *"}),e.jsx(c,{id:"phone",name:"phone",type:"tel",required:!0,className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"input-phone"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"jobTitle",className:"text-gray-300",children:"الوظيفة*"}),e.jsxs(D,{name:"jobTitle",required:!0,children:[e.jsx(C,{className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"select-jobtitle",children:e.jsx(F,{placeholder:"اختر الوظيفة"})}),e.jsxs(U,{className:"bg-[#2d1f1a] border-primary/20 text-white",children:[e.jsx(d,{value:"كاشير",children:"كاشير"}),e.jsx(d,{value:"محاسب",children:"محاسب"}),e.jsx(d,{value:"بائع",children:"بائع"}),e.jsx(d,{value:"عارض",children:"عارض"}),e.jsx(d,{value:"سائق توصيل",children:"سائق توصيل"}),e.jsx(d,{value:"مدير",children:"مدير"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsxs(t,{className:"text-gray-300 flex items-center gap-1",children:[e.jsx(qe,{className:"w-4 h-4"}),"الدور في النظام *"]}),e.jsxs(D,{value:V,onValueChange:H,children:[e.jsx(C,{className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"select-role",children:e.jsx(F,{placeholder:"اختر الدور"})}),e.jsxs(U,{className:"bg-[#2d1f1a] border-primary/20 text-white",children:[e.jsx(d,{value:"cashier",children:"كاشير"}),e.jsx(d,{value:"accountant",children:"محاسب"}),e.jsx(d,{value:"driver",children:"سائق توصيل"}),f&&e.jsx(d,{value:"manager",children:"مدير فرع"}),u?.role==="admin"&&e.jsx(d,{value:"admin",children:"مدير عام"})]})]})]}),f&&e.jsxs("div",{children:[e.jsxs(t,{className:"text-gray-300 flex items-center gap-1",children:[e.jsx(Ie,{className:"w-4 h-4"}),"الفرع ",V==="manager"?"*":""]}),e.jsxs(D,{value:A,onValueChange:Q,children:[e.jsx(C,{className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"select-branch",children:e.jsx(F,{placeholder:"اختر الفرع"})}),e.jsx(U,{className:"bg-[#2d1f1a] border-primary/20 text-white",children:xe.map(a=>e.jsx(d,{value:a.id,children:a.nameAr},a.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"shiftStartTime",className:"text-gray-300",children:"وقت بداية الدوام"}),e.jsx(c,{id:"shiftStartTime",name:"shiftStartTime",type:"time",className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"input-shiftstart"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"shiftEndTime",className:"text-gray-300",children:"وقت نهاية الدوام"}),e.jsx(c,{id:"shiftEndTime",name:"shiftEndTime",type:"time",className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"input-shiftend"})]})]}),e.jsxs("div",{children:[e.jsx(t,{className:"text-gray-300 block mb-2",children:"أيام الدوام"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"].map(a=>e.jsxs("label",{className:"flex items-center gap-2 text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"workDays",value:a,className:"w-4 h-4 rounded border-primary/30 bg-[#1a1410]","data-testid":`checkbox-workday-${a}`}),e.jsx("span",{className:"text-sm",children:a})]},a))})]}),e.jsxs("div",{children:[e.jsx(t,{className:"text-gray-300 block mb-2",children:"الصلاحيات"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 bg-[#1a1410] p-3 rounded-lg border border-primary/10",children:J.map(a=>e.jsxs("label",{className:"flex items-center gap-2 text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x.includes(a.id),onChange:s=>{s.target.checked?j([...x,a.id]):j(x.filter(r=>r!==a.id))},className:"w-4 h-4 rounded border-primary/30 bg-[#1a1410]"}),e.jsx("span",{className:"text-sm",children:a.label})]},a.id))})]}),e.jsxs("div",{children:[e.jsx(t,{className:"text-gray-300 block mb-2",children:"الصفحات المسموحة"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 bg-[#1a1410] p-3 rounded-lg border border-primary/10",children:G.map(a=>e.jsxs("label",{className:"flex items-center gap-2 text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g.includes(a.id),onChange:s=>{s.target.checked?b([...g,a.id]):b(g.filter(r=>r!==a.id))},className:"w-4 h-4 rounded border-primary/30 bg-[#1a1410]"}),e.jsx("span",{className:"text-sm",children:a.label})]},a.id))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"deviceBalance",className:"text-gray-300",children:"رصيد الأجهزة"}),e.jsx(c,{id:"deviceBalance",name:"deviceBalance",type:"number",min:"0",defaultValue:"0",className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"input-devicebalance"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"commissionPercentage",className:"text-gray-300",children:"نسبةالعمولة(%)"}),e.jsx(c,{id:"commissionPercentage",name:"commissionPercentage",type:"number",step:"0.1",min:"0",max:"100",defaultValue:"0",className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"input-commission"})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"employeeImage",className:"text-gray-300",children:"صورة الموظف"}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{ref:K,type:"file",accept:"image/*",className:"hidden",onChange:a=>{const s=a.currentTarget.files?.[0];s&&je(s)},"data-testid":"input-employee-image"}),e.jsxs(m,{type:"button",variant:"outline",onClick:()=>K.current?.click(),disabled:I,className:"w-full border-primary/30 text-accent",children:[e.jsx(te,{className:"w-4 h-4 ml-2"}),I?"جاري الرفع...":"اختر صورة"]})]}),B&&e.jsx(m,{type:"button",variant:"outline",size:"icon",onClick:()=>{v(null),N(null),k(null)},className:"border-red-500/30 text-red-500","data-testid":"button-remove-image",children:e.jsx(re,{className:"w-4 h-4"})})]}),B&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:B,alt:"معاينة",className:"w-20 h-20 rounded-lg object-cover"})})]}),e.jsx("div",{className:"bg-background0/10 border border-primary/30 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-accent/90",children:'سيتم إنشاء الموظف بدون كلمة مرور. يجب على الموظف الذهاب إلى صفحة "موظف جديد" لإنشاء كلمة المرور الخاصةبه.'})}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-2",children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>{O(!1),v(null),N(null),k(null)},className:"border-gray-600 text-gray-300 w-full sm:w-auto hover-elevate","data-testid":"button-cancel-add",children:"إلغاء"}),e.jsx(m,{type:"submit",disabled:L.isPending,className:"bg-gradient-to-r from-amber-500 to-amber-700 w-full sm:w-auto hover-elevate active-elevate-2","data-testid":"button-submit-add",children:L.isPending?"جاري الإضافة...":"إضافة الموظف"})]})]})]})]})}),he?e.jsx("div",{className:"text-center text-accent py-12",children:"جاري تحميل الموظفين..."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:(w||[]).map(a=>e.jsxs(Ee,{className:"bg-gradient-to-br from-background to-background border-primary/20 overflow-hidden hover-elevate","data-testid":`card-employee-${a.id}`,children:[e.jsx(De,{className:"bg-gradient-to-r from-amber-500/20 to-amber-700/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Ce,{className:"text-accent flex items-center gap-2",children:[a.imageUrl?e.jsx("img",{src:a.imageUrl,alt:a.fullName,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-amber-500 to-amber-700 rounded-full flex items-center justify-center",children:e.jsx(ie,{className:"w-6 h-6 text-white"})}),e.jsx("span",{children:a.fullName})]}),e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>S(a),className:"text-accent hover:bg-background0/10","data-testid":`button-edit-${a.id}`,children:e.jsx(Re,{className:"w-4 h-4"})})]})}),e.jsxs(Fe,{className:"pt-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(ie,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm",children:a.jobTitle}),e.jsx(Ue,{className:a.isActivated?"bg-green-500":"bg-gray-500","data-testid":`badge-status-${a.id}`,children:a.isActivated?"مفعّل":"غير مفعّل"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(Oe,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm",children:a.phone})]}),a.shiftTime&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(Be,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm",children:a.shiftTime})]}),a.commissionPercentage!==void 0&&a.commissionPercentage>0&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(Ve,{className:"w-4 h-4 text-accent"}),e.jsxs("span",{className:"text-sm",children:["عمولة: ",a.commissionPercentage,"%"]})]}),e.jsx("div",{className:"pt-2 border-t border-primary/20",children:e.jsxs("p",{className:"text-xs text-gray-400",children:["اسم المستخدم: ",a.username]})})]})]},a.id))}),i&&e.jsx(Y,{open:!!i,onOpenChange:()=>S(null),children:e.jsxs(ee,{className:"bg-[#2d1f1a] border-primary/20 text-white w-full max-w-sm sm:max-w-md md:max-w-lg lg:max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ae,{children:e.jsx(se,{className:"text-accent",children:"تعديل بيانات الموظف"})}),e.jsxs("form",{onSubmit:pe,className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-fullName",className:"text-gray-300",children:"الاسم الكامل *"}),e.jsx(c,{id:"edit-fullName",name:"fullName",required:!0,defaultValue:i.fullName,className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"input-edit-fullname"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-phone",className:"text-gray-300",children:"رقم الهاتف *"}),e.jsx(c,{id:"edit-phone",name:"phone",type:"tel",required:!0,defaultValue:i.phone,className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"input-edit-phone"})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-jobTitle",className:"text-gray-300",children:"الوظيفة*"}),e.jsxs(D,{name:"jobTitle",defaultValue:i.jobTitle,required:!0,children:[e.jsx(C,{className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"select-edit-jobtitle",children:e.jsx(F,{})}),e.jsxs(U,{className:"bg-[#2d1f1a] border-primary/20 text-white",children:[e.jsx(d,{value:"كاشير",children:"كاشير"}),e.jsx(d,{value:"محاسب",children:"محاسب"}),e.jsx(d,{value:"بائع",children:"بائع"}),e.jsx(d,{value:"عارض",children:"عارض"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-shiftStartTime",className:"text-gray-300",children:"وقت بداية الدوام"}),e.jsx(c,{id:"edit-shiftStartTime",name:"shiftStartTime",type:"time",defaultValue:i.shiftStartTime,className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"input-edit-shiftstart"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-shiftEndTime",className:"text-gray-300",children:"وقت نهاية الدوام"}),e.jsx(c,{id:"edit-shiftEndTime",name:"shiftEndTime",type:"time",defaultValue:i.shiftEndTime,className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"input-edit-shiftend"})]})]}),e.jsxs("div",{children:[e.jsx(t,{className:"text-gray-300 block mb-2",children:"أيام الدوام"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"].map(a=>e.jsxs("label",{className:"flex items-center gap-2 text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"workDays",value:a,defaultChecked:i.workDays?.includes(a),className:"w-4 h-4 rounded border-primary/30 bg-[#1a1410]","data-testid":`checkbox-edit-workday-${a}`}),e.jsx("span",{className:"text-sm",children:a})]},a))})]}),e.jsxs("div",{children:[e.jsx(t,{className:"text-gray-300 block mb-2",children:"الصلاحيات"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 bg-[#1a1410] p-3 rounded-lg border border-primary/10",children:J.map(a=>e.jsxs("label",{className:"flex items-center gap-2 text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x.includes(a.id),onChange:s=>{s.target.checked?j([...x,a.id]):j(x.filter(r=>r!==a.id))},className:"w-4 h-4 rounded border-primary/30 bg-[#1a1410]"}),e.jsx("span",{className:"text-sm",children:a.label})]},a.id))})]}),e.jsxs("div",{children:[e.jsx(t,{className:"text-gray-300 block mb-2",children:"الصفحات المسموحة"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 bg-[#1a1410] p-3 rounded-lg border border-primary/10",children:G.map(a=>e.jsxs("label",{className:"flex items-center gap-2 text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g.includes(a.id),onChange:s=>{s.target.checked?b([...g,a.id]):b(g.filter(r=>r!==a.id))},className:"w-4 h-4 rounded border-primary/30 bg-[#1a1410]"}),e.jsx("span",{className:"text-sm",children:a.label})]},a.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-deviceBalance",className:"text-gray-300",children:"رصيد الأجهزة"}),e.jsx(c,{id:"edit-deviceBalance",name:"deviceBalance",type:"number",min:"0",defaultValue:i.deviceBalance||0,className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"input-edit-devicebalance"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-commissionPercentage",className:"text-gray-300",children:"نسبةالعمولة(%)"}),e.jsx(c,{id:"edit-commissionPercentage",name:"commissionPercentage",type:"number",step:"0.1",min:"0",max:"100",defaultValue:i.commissionPercentage||0,className:"bg-[#1a1410] border-primary/30 text-white","data-testid":"input-edit-commission"})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"edit-employeeImage",className:"text-gray-300",children:"صورة الموظف"}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{ref:z,type:"file",accept:"image/*",className:"hidden",onChange:a=>{const s=a.currentTarget.files?.[0];s&&be(s)},"data-testid":"input-edit-employee-image"}),e.jsxs(m,{type:"button",variant:"outline",onClick:()=>z.current?.click(),disabled:I,className:"w-full border-primary/30 text-accent",children:[e.jsx(te,{className:"w-4 h-4 ml-2"}),I?"جاري الرفع...":"اختر صورة جديدة"]})]}),q&&e.jsx(m,{type:"button",variant:"outline",size:"icon",onClick:()=>{P(null),T(null),R(null)},className:"border-red-500/30 text-red-500","data-testid":"button-remove-edit-image",children:e.jsx(re,{className:"w-4 h-4"})})]}),q?e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:q,alt:"معاينة جديدة",className:"w-20 h-20 rounded-lg object-cover"})}):i.imageUrl?e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:i.imageUrl,alt:i.fullName,className:"w-20 h-20 rounded-lg object-cover"})}):null]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>{S(null),P(null),T(null),R(null)},className:"border-gray-600 text-gray-300","data-testid":"button-cancel-edit",children:"إلغاء"}),e.jsx(m,{type:"submit",disabled:M.isPending,className:"bg-gradient-to-r from-amber-500 to-amber-700","data-testid":"button-submit-edit",children:M.isPending?"جاري التحديث...":"حفظ التغييرات"})]})]})]})})]})})}export{ea as default};
