import{j as e}from"./vendor-ui-DJm-zmnP.js";import{a as v,b as k}from"./vendor-query-CX8ZYlKb.js";import{l as u,u as w,c as _,e as C,B as n,A as P,g as q,C as t,I as d,v as S,N as T}from"./index-61RjstaY.js";import{r as f}from"./vendor-react-Bzsngnqy.js";import{C as L}from"./CustomerLayout-CdXUKo9S.js";import{T as R}from"./trending-up-CK4Nk2TF.js";import{U as E}from"./users-Btf_-tK9.js";import"./vendor-utils-BKCsaWdX.js";import"./customer-footer-DgAPx-ud.js";import"./clipboard-list-BeoGODTJ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=u("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=u("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);function V(){const{t:r,i18n:m}=w(),[,j]=_(),{toast:i}=C(),[c,x]=f.useState(""),[p,h]=f.useState(""),{data:a}=v({queryKey:["/api/referrals"],queryFn:async()=>(await fetch("/api/referrals")).json()}),o=k({mutationFn:async()=>S("POST","/api/referrals/invite",{referredPhone:c,referredEmail:p}),onSuccess:()=>{T.invalidateQueries({queryKey:["/api/referrals"]}),x(""),h(""),i({title:r("referral.invite_sent")||"تم إرسال الدعوة",description:r("referral.invite_sent_desc")||"تم إرسال رمز الإحالة بنجاح"})}}),l=a?.code||"LOAD",g=a?.completed||0,b=a?.points||0,y=()=>{navigator.clipboard.writeText(l),i({title:r("common.copied")||"تم النسخ",description:r("referral.code_copied")||"تم نسخ الرمز إلى الحافظة"})},N=()=>{const s=r("referral.share_text",{code:l})||`هيا تابعني واستخدم رمزي ${l} واحصل على 50 نقطة!`;navigator.share?navigator.share({text:s,title:r("referral.title")||"برنامج الإحالات"}):(navigator.clipboard.writeText(s),i({title:r("common.copied")||"تم النسخ",description:r("referral.share_copied")||"تم نسخ رسالة المشاركة"}))};return e.jsx(L,{children:e.jsxs("div",{className:"space-y-6 p-4 max-w-2xl mx-auto pb-24",dir:m.language==="ar"?"rtl":"ltr",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>j("/menu"),"data-testid":"button-back",children:m.language==="ar"?e.jsx(P,{className:"w-5 h-5"}):e.jsx(q,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-3xl font-bold",children:r("referral.title")||"برنامج الإحالات"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(t,{className:"p-4","data-testid":"card-referral-stats",children:[e.jsx(R,{className:"w-8 h-8 text-green-500 mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r("referral.successful")||"الإحالات الناجحة"}),e.jsx("p",{className:"text-2xl font-bold",children:g})]}),e.jsxs(t,{className:"p-4","data-testid":"card-referral-points",children:[e.jsx(E,{className:"w-8 h-8 text-blue-500 mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r("referral.points_earned")||"النقاط المكتسبة"}),e.jsx("p",{className:"text-2xl font-bold",children:b})]})]}),e.jsxs(t,{className:"p-6 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20","data-testid":"card-referral-code",children:[e.jsx("h3",{className:"font-semibold mb-3",children:r("referral.unique_code")||"رمز الإحالة الفريد"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx(d,{value:l,readOnly:!0,"data-testid":"input-referral-code",className:"text-lg font-mono font-bold"}),e.jsx(n,{onClick:y,size:"icon",variant:"default","data-testid":"button-copy-code",children:e.jsx(A,{className:"w-4 h-4"})})]}),e.jsxs(n,{onClick:N,variant:"outline",className:"w-full","data-testid":"button-share-referral",children:[e.jsx(z,{className:"w-4 h-4 ml-2"}),r("referral.share_code")||"شارك الرمز"]})]}),e.jsxs(t,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:r("referral.refer_friend")||"إحالة صديق جديد"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm mb-2 block",children:r("referral.phone_label")||"رقم الهاتف"}),e.jsx(d,{type:"tel",value:c,onChange:s=>x(s.target.value),placeholder:r("referral.phone_placeholder")||"رقم الهاتف","data-testid":"input-referral-phone"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm mb-2 block",children:r("referral.email_label")||"البريد الإلكتروني (اختياري)"}),e.jsx(d,{type:"email",value:p,onChange:s=>h(s.target.value),placeholder:r("referral.email_placeholder")||"البريد الإلكتروني","data-testid":"input-referral-email"})]}),e.jsx(n,{onClick:()=>o.mutate(),disabled:!c||o.isPending,className:"w-full","data-testid":"button-send-referral",children:o.isPending?r("common.sending")||"جاري الإرسال...":r("referral.send_invite")||"إرسال الدعوة"})]})]}),e.jsxs(t,{className:"p-6 bg-background dark:bg-primary/20",children:[e.jsx("h3",{className:"font-semibold mb-3",children:r("referral.how_it_works")||"كيفية برنامج الإحالات"}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-green-500 font-bold",children:"✓"}),e.jsx("span",{children:r("referral.step1")||"شارك رمزك مع الأصدقاء"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-green-500 font-bold",children:"✓"}),e.jsx("span",{children:r("referral.step2")||"احصل على 50 نقطة لكل إحالة ناجحة"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-green-500 font-bold",children:"✓"}),e.jsx("span",{children:r("referral.step3")||"الحد الأقصى للنقاط غير محدود"})]}),e.jsxs("li",{className:"flex gap-2",children:[e.jsx("span",{className:"text-green-500 font-bold",children:"✓"}),e.jsx("span",{children:r("referral.step4")||"استخدم النقاط للحصول على خصومات وعروض"})]})]})]}),a?.list&&a.list.length>0&&e.jsxs(t,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:r("referral.recent_referrals")||"الإحالات الأخيرة"}),e.jsx("div",{className:"space-y-2",children:a.list.map(s=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-muted rounded","data-testid":`item-referral-${s.id}`,children:[e.jsx("span",{children:s.referredPhone}),e.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded ${s.status==="completed"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300"}`,children:s.status==="completed"?r("referral.status_completed")||"مكتملة":r("referral.status_pending")||"قيد الانتظار"})]},s.id))})]})]})})}export{V as default};
