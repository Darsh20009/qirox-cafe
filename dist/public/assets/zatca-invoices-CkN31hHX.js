import{j as e}from"./vendor-ui-DJm-zmnP.js";import{r as u}from"./vendor-react-Bzsngnqy.js";import{a as P,b as we}from"./vendor-query-CX8ZYlKb.js";import{l as le,c as Ce,e as Te,B as r,g as ke,C as x,f as m,T as Z,r as L,aa as Ae,ab as Se,ac as T,ai as k,X as Fe,I as j,q as Ve,j as o,x as g,y as p,L as l,V as A,R as S,D as O,E,F as B,H as _,K as H,v as Le,N as Ie,a3 as Re}from"./index-CLvpp2UE.js";import{S as K,a as $,b as U,c as G,d as h}from"./select-BzAjeBJu.js";import{T as J,a as W,b as f,c as n,d as Y,e as c}from"./table-DVDQb40v.js";import{R as F}from"./receipt-7jFYni-X.js";import{S as ee}from"./settings-CIxkmZWE.js";import{R as Qe}from"./refresh-cw-BuGj2LMM.js";import{C as N}from"./circle-check-big-DlXUvwLH.js";import{C as I}from"./circle-x-B1Jm2Zh7.js";import{F as De}from"./file-text-QZcL_gux.js";import{S as se}from"./shield-BnyrfBf-.js";import{E as Xe}from"./eye-cZNGFzyE.js";import{S as re}from"./send-tv7GiiF9.js";import{P as ae}from"./printer-CMPCONS0.js";import{B as ze}from"./building-2-H4-dEMu_.js";import{f as Me}from"./vendor-utils-BKCsaWdX.js";import{a as qe}from"./ar-CeWsqWSX.js";import"./chevron-down-CqdH-ack.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=le("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=le("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),V={pending:{label:"قيد الانتظار",color:"bg-background0",icon:L},submitted:{label:"تم الإرسال",color:"bg-blue-500",icon:re},accepted:{label:"مقبولة",color:"bg-green-500",icon:N},rejected:{label:"مرفوضة",color:"bg-red-500",icon:I},cancelled:{label:"ملغاة",color:"bg-gray-500",icon:I}},te={standard:"فاتورة ضريبية",simplified:"فاتورة مبسطة",debit_note:"إشعار مدين",credit_note:"إشعار دائن"},Oe={cash:"نقدي",pos:"بطاقة",bank_transfer:"تحويل بنكي",mada:"مدى",stc_pay:"STC Pay",apple_pay:"Apple Pay"};function ds(){const[,ce]=Ce(),{toast:R}=Te(),[ie,ne]=u.useState("invoices"),[v,de]=u.useState(""),[y,xe]=u.useState("all"),[w,me]=u.useState("all"),[d,oe]=u.useState(null),[he,C]=u.useState(!1),[Q,je]=u.useState(""),[ue,b]=u.useState(!1),{data:i=[],isLoading:ge,refetch:pe}=P({queryKey:["/api/zatca/invoices"]}),{data:t}=P({queryKey:["/api/zatca/settings"]}),D=we({mutationFn:async s=>Le("POST",`/api/zatca/submit/${s}`),onSuccess:()=>{Ie.invalidateQueries({queryKey:["/api/zatca/invoices"]}),R({title:"تم إرسال الفاتورة بنجاح"})},onError:()=>{R({title:"فشل إرسال الفاتورة",variant:"destructive"})}}),Ne=async s=>{try{const a=await Re.toDataURL(s,{width:200});je(a)}catch(a){console.error("Failed to generate QR code:",a)}},be=async s=>{oe(s),s.zatcaQRCode&&await Ne(s.zatcaQRCode),C(!0)},X=i.filter(s=>{const a=s.invoiceNumber.toLowerCase().includes(v.toLowerCase())||s.orderNumber.toLowerCase().includes(v.toLowerCase())||s.customerName.includes(v),ve=y==="all"||s.status===y,ye=w==="all"||s.invoiceType===w;return a&&ve&&ye}),z=i.filter(s=>s.status==="pending").length,M=i.filter(s=>s.status==="accepted").length,q=i.filter(s=>s.status==="rejected").length,fe=i.filter(s=>s.status==="accepted").reduce((s,a)=>s+a.vatAmount,0);return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-amber-50 via-primary/5 to-yellow-50 dark:from-background dark:via-primary/5 dark:to-background",dir:"rtl",children:e.jsxs("div",{className:"container mx-auto p-4 md:p-6 max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-6",children:[e.jsxs(r,{variant:"ghost",onClick:()=>ce("/manager/accounting"),className:"text-accent dark:text-accent",children:[e.jsx(ke,{className:"w-4 h-4 ml-2"}),"العودة"]}),e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-accent dark:text-accent flex items-center gap-2",children:[e.jsx(F,{className:"w-8 h-8"}),"الفوترة الإلكترونية - ZATCA"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>b(!0),children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>pe(),children:e.jsx(Qe,{className:"w-4 h-4"})})]})]}),!t?.isConfigured&&e.jsx(x,{className:"mb-6 border-primary bg-background dark:bg-primary/20",children:e.jsxs(m,{className:"flex items-center gap-4 p-4",children:[e.jsx(Z,{className:"w-8 h-8 text-accent"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-accent dark:text-accent",children:"لم يتم تكوين إعدادات ZATCA"}),e.jsx("p",{className:"text-sm text-accent",children:"يرجى إعداد بيانات المنشأة والرقم الضريبي قبل إرسال الفواتير"})]}),e.jsx(r,{onClick:()=>b(!0),className:"mr-auto bg-primary hover:bg-primary",children:"إعداد الآن"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(x,{className:"bg-gradient-to-br from-amber-500 to-amber-600 text-white",children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-accent text-sm",children:"قيد الانتظار"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:z}),e.jsx("p",{className:"text-accent text-xs mt-1",children:"فاتورة"})]}),e.jsx(L,{className:"w-12 h-12 text-accent"})]})})}),e.jsx(x,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white",children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm",children:"مقبولة"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:M}),e.jsx("p",{className:"text-green-200 text-xs mt-1",children:"فاتورة"})]}),e.jsx(N,{className:"w-12 h-12 text-green-200"})]})})}),e.jsx(x,{className:"bg-gradient-to-br from-red-500 to-red-600 text-white",children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-red-100 text-sm",children:"مرفوضة"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:q}),e.jsx("p",{className:"text-red-200 text-xs mt-1",children:"فاتورة"})]}),e.jsx(I,{className:"w-12 h-12 text-red-200"})]})})}),e.jsx(x,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm",children:"إجمالي الضريبة"}),e.jsx("p",{className:"text-3xl font-bold mt-1",children:fe.toFixed(2)}),e.jsx("p",{className:"text-blue-200 text-xs mt-1",children:"ريال سعودي"})]}),e.jsx(F,{className:"w-12 h-12 text-blue-200"})]})})})]}),e.jsxs(Ae,{value:ie,onValueChange:ne,className:"space-y-6",children:[e.jsxs(Se,{className:"grid w-full grid-cols-3 bg-primary dark:bg-primary/30",children:[e.jsxs(T,{value:"invoices",className:"flex items-center gap-1",children:[e.jsx(De,{className:"w-4 h-4"}),"الفواتير"]}),e.jsxs(T,{value:"compliance",className:"flex items-center gap-1",children:[e.jsx(se,{className:"w-4 h-4"}),"الامتثال"]}),e.jsxs(T,{value:"reports",className:"flex items-center gap-1",children:[e.jsx(Pe,{className:"w-4 h-4"}),"التقارير"]})]}),e.jsxs(k,{value:"invoices",className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Fe,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(j,{placeholder:"بحث برقم الفاتورة أو الطلب...",value:v,onChange:s=>de(s.target.value),className:"pr-10"})]}),e.jsxs(K,{value:y,onValueChange:xe,children:[e.jsx($,{className:"w-40",children:e.jsx(U,{placeholder:"الحالة"})}),e.jsxs(G,{children:[e.jsx(h,{value:"all",children:"جميع الحالات"}),e.jsx(h,{value:"pending",children:"قيد الانتظار"}),e.jsx(h,{value:"submitted",children:"تم الإرسال"}),e.jsx(h,{value:"accepted",children:"مقبولة"}),e.jsx(h,{value:"rejected",children:"مرفوضة"})]})]}),e.jsxs(K,{value:w,onValueChange:me,children:[e.jsx($,{className:"w-48",children:e.jsx(U,{placeholder:"نوع الفاتورة"})}),e.jsxs(G,{children:[e.jsx(h,{value:"all",children:"جميع الأنواع"}),e.jsx(h,{value:"standard",children:"فاتورة ضريبية"}),e.jsx(h,{value:"simplified",children:"فاتورة مبسطة"}),e.jsx(h,{value:"debit_note",children:"إشعار مدين"}),e.jsx(h,{value:"credit_note",children:"إشعار دائن"})]})]})]}),e.jsx(x,{children:e.jsx(m,{className:"p-0",children:ge?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(Ve,{className:"w-8 h-8 animate-spin text-accent"})}):e.jsxs(J,{children:[e.jsx(W,{children:e.jsxs(f,{children:[e.jsx(n,{className:"text-right",children:"رقم الفاتورة"}),e.jsx(n,{className:"text-right",children:"النوع"}),e.jsx(n,{className:"text-right",children:"العميل"}),e.jsx(n,{className:"text-right",children:"المبلغ"}),e.jsx(n,{className:"text-right",children:"الضريبة"}),e.jsx(n,{className:"text-right",children:"التاريخ"}),e.jsx(n,{className:"text-right",children:"الحالة"}),e.jsx(n,{className:"text-right",children:"إجراءات"})]})}),e.jsxs(Y,{children:[X.map(s=>{const a=V[s.status]?.icon||L;return e.jsxs(f,{children:[e.jsx(c,{className:"font-mono font-medium",children:s.invoiceNumber}),e.jsx(c,{children:e.jsx(o,{variant:"outline",children:te[s.invoiceType]})}),e.jsx(c,{children:s.customerName}),e.jsxs(c,{className:"font-medium",children:[s.totalAmount.toFixed(2)," ر.س"]}),e.jsxs(c,{className:"text-accent",children:[s.vatAmount.toFixed(2)," ر.س"]}),e.jsx(c,{className:"text-sm",children:Me(new Date(s.createdAt),"dd/MM/yyyy",{locale:qe})}),e.jsx(c,{children:e.jsxs(o,{className:`${V[s.status]?.color} text-white`,children:[e.jsx(a,{className:"w-3 h-3 ml-1"}),V[s.status]?.label]})}),e.jsx(c,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(r,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>be(s),children:e.jsx(Xe,{className:"w-4 h-4"})}),s.status==="pending"&&e.jsx(r,{variant:"ghost",size:"icon",className:"h-8 w-8 text-green-600",onClick:()=>D.mutate(s.id||""),disabled:D.isPending,children:e.jsx(re,{className:"w-4 h-4"})}),s.status==="accepted"&&e.jsx(r,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ae,{className:"w-4 h-4"})})]})})]},s.id)}),X.length===0&&e.jsx(f,{children:e.jsx(c,{colSpan:8,className:"text-center text-muted-foreground py-8",children:"لا توجد فواتير"})})]})]})})})]}),e.jsxs(k,{value:"compliance",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(x,{children:[e.jsx(g,{children:e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5 text-accent"}),"بيانات المنشأة"]})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-sm",children:"اسم المنشأة"}),e.jsx("p",{className:"font-medium",children:t?.sellerName||"غير محدد"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-sm",children:"الرقم الضريبي"}),e.jsx("p",{className:"font-mono font-medium",children:t?.vatNumber||"غير محدد"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-sm",children:"رقم السجل التجاري"}),e.jsx("p",{className:"font-mono",children:t?.crNumber||"غير محدد"})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-sm",children:"المدينة"}),e.jsx("p",{children:t?.city||"غير محدد"})]})]}),e.jsx(r,{onClick:()=>b(!0),variant:"outline",className:"w-full",children:"تعديل البيانات"})]})]}),e.jsxs(x,{children:[e.jsx(g,{children:e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5 text-green-600"}),"حالة الامتثال"]})}),e.jsx(m,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{children:"توليد رمز QR"})]}),e.jsx(o,{variant:"outline",className:"bg-green-50 text-green-700",children:"متوافق"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{children:"حساب الضريبة"})]}),e.jsx(o,{variant:"outline",className:"bg-green-50 text-green-700",children:"15% VAT"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{children:"تنسيق TLV"})]}),e.jsx(o,{variant:"outline",className:"bg-green-50 text-green-700",children:"متوافق"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t?.vatNumber?e.jsx(N,{className:"w-5 h-5 text-green-500"}):e.jsx(Z,{className:"w-5 h-5 text-accent"}),e.jsx("span",{children:"الرقم الضريبي"})]}),e.jsx(o,{variant:"outline",className:t?.vatNumber?"bg-green-50 text-green-700":"bg-background text-accent",children:t?.vatNumber?"مسجل":"غير مسجل"})]})]})})]})]}),e.jsxs(x,{children:[e.jsx(g,{children:e.jsxs(p,{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"w-5 h-5 text-blue-600"}),"متطلبات ZATCA Phase 2"]})}),e.jsx(m,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"الفواتير الإلكترونية"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"جميع الفواتير تُنشأ بتنسيق إلكتروني متوافق مع متطلبات هيئة الزكاة"})]}),e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"رمز QR"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"كل فاتورة تحتوي على رمز QR يتضمن بيانات TLV المطلوبة"})]}),e.jsxs("div",{className:"p-4 bg-background dark:bg-primary/20 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"التكامل مع ZATCA"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"إرسال الفواتير تلقائياً لمنصة FATOORA للتحقق والاعتماد"})]})]})})]})]}),e.jsxs(k,{value:"reports",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(x,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"تقرير الضريبة الشهري"}),e.jsx(A,{children:"ملخص ضريبة القيمة المضافة"})]}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{children:"إجمالي المبيعات"}),e.jsxs("span",{className:"font-bold",children:[i.reduce((s,a)=>s+a.subtotal,0).toFixed(2)," ر.س"]})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{children:"إجمالي الخصومات"}),e.jsxs("span",{className:"font-bold text-red-600",children:["-",i.reduce((s,a)=>s+a.discountTotal,0).toFixed(2)," ر.س"]})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsx("span",{children:"المبلغ الخاضع للضريبة"}),e.jsxs("span",{className:"font-bold",children:[i.reduce((s,a)=>s+a.taxableAmount,0).toFixed(2)," ر.س"]})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-background dark:bg-primary/20 rounded-lg border border-primary dark:border-primary",children:[e.jsx("span",{className:"font-medium",children:"ضريبة القيمة المضافة (15%)"}),e.jsxs("span",{className:"font-bold text-accent",children:[i.reduce((s,a)=>s+a.vatAmount,0).toFixed(2)," ر.س"]})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[e.jsx("span",{className:"font-medium",children:"إجمالي المبالغ"}),e.jsxs("span",{className:"font-bold text-green-600",children:[i.reduce((s,a)=>s+a.totalAmount,0).toFixed(2)," ر.س"]})]})]})})]}),e.jsxs(x,{children:[e.jsxs(g,{children:[e.jsx(p,{children:"إحصائيات الفواتير"}),e.jsx(A,{children:"توزيع الفواتير حسب الحالة والنوع"})]}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"حسب الحالة"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex justify-between p-2 bg-background dark:bg-primary/20 rounded",children:[e.jsx("span",{className:"text-sm",children:"قيد الانتظار"}),e.jsx(o,{variant:"outline",children:z})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-green-50 dark:bg-green-900/20 rounded",children:[e.jsx("span",{className:"text-sm",children:"مقبولة"}),e.jsx(o,{variant:"outline",children:M})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-red-50 dark:bg-red-900/20 rounded",children:[e.jsx("span",{className:"text-sm",children:"مرفوضة"}),e.jsx(o,{variant:"outline",children:q})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-blue-50 dark:bg-blue-900/20 rounded",children:[e.jsx("span",{className:"text-sm",children:"تم الإرسال"}),e.jsx(o,{variant:"outline",children:i.filter(s=>s.status==="submitted").length})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"حسب النوع"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex justify-between p-2 bg-muted/50 rounded",children:[e.jsx("span",{className:"text-sm",children:"فاتورة ضريبية"}),e.jsx(o,{variant:"outline",children:i.filter(s=>s.invoiceType==="standard").length})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-muted/50 rounded",children:[e.jsx("span",{className:"text-sm",children:"فاتورة مبسطة"}),e.jsx(o,{variant:"outline",children:i.filter(s=>s.invoiceType==="simplified").length})]})]})]})]})})]})]}),e.jsxs(x,{children:[e.jsx(g,{className:"flex flex-row items-center justify-between",children:e.jsxs("div",{children:[e.jsx(p,{children:"تصدير التقارير"}),e.jsx(A,{children:"تحميل تقارير الضريبة بصيغ مختلفة"})]})}),e.jsx(m,{children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs(r,{variant:"outline",children:[e.jsx(S,{className:"w-4 h-4 ml-2"}),"تقرير VAT (PDF)"]}),e.jsxs(r,{variant:"outline",children:[e.jsx(S,{className:"w-4 h-4 ml-2"}),"سجل الفواتير (Excel)"]}),e.jsxs(r,{variant:"outline",children:[e.jsx(S,{className:"w-4 h-4 ml-2"}),"ملف ZATCA (XML)"]})]})})]})]})]}),e.jsx(O,{open:he,onOpenChange:C,children:e.jsxs(E,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(B,{children:e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5"}),"تفاصيل الفاتورة - ",d?.invoiceNumber]})}),d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-sm",children:"رقم الطلب"}),e.jsx("p",{className:"font-mono",children:d.orderNumber})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-sm",children:"نوع الفاتورة"}),e.jsx("p",{children:te[d.invoiceType]})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-sm",children:"العميل"}),e.jsx("p",{children:d.customerName})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-muted-foreground text-sm",children:"طريقة الدفع"}),e.jsx("p",{children:Oe[d.paymentMethod]||d.paymentMethod})]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"تفاصيل المنتجات"}),e.jsxs(J,{children:[e.jsx(W,{children:e.jsxs(f,{children:[e.jsx(n,{className:"text-right",children:"المنتج"}),e.jsx(n,{className:"text-right",children:"الكمية"}),e.jsx(n,{className:"text-right",children:"السعر"}),e.jsx(n,{className:"text-right",children:"الضريبة"}),e.jsx(n,{className:"text-right",children:"الإجمالي"})]})}),e.jsx(Y,{children:d.items?.map((s,a)=>e.jsxs(f,{children:[e.jsx(c,{children:s.nameAr}),e.jsx(c,{children:s.quantity}),e.jsx(c,{children:s.unitPrice.toFixed(2)}),e.jsx(c,{children:s.taxAmount.toFixed(2)}),e.jsx(c,{children:s.totalAmount.toFixed(2)})]},a))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"المجموع الفرعي"}),e.jsxs("p",{className:"font-medium",children:[d.subtotal.toFixed(2)," ر.س"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"الخصم"}),e.jsxs("p",{className:"font-medium text-red-600",children:["-",d.discountTotal.toFixed(2)," ر.س"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"ضريبة القيمة المضافة"}),e.jsxs("p",{className:"font-medium text-accent",children:[d.vatAmount.toFixed(2)," ر.س"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"الإجمالي"}),e.jsxs("p",{className:"text-xl font-bold text-green-600",children:[d.totalAmount.toFixed(2)," ر.س"]})]})]}),Q&&e.jsxs("div",{className:"flex flex-col items-center p-4 bg-white rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"رمز QR - ZATCA"}),e.jsx("img",{src:Q,alt:"ZATCA QR Code",className:"w-32 h-32"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"امسح للتحقق من صحة الفاتورة"})]})]}),e.jsxs(H,{children:[e.jsx(r,{variant:"outline",onClick:()=>C(!1),children:"إغلاق"}),e.jsxs(r,{className:"bg-primary hover:bg-primary",children:[e.jsx(ae,{className:"w-4 h-4 ml-2"}),"طباعة"]})]})]})}),e.jsx(O,{open:ue,onOpenChange:b,children:e.jsxs(E,{className:"max-w-lg",children:[e.jsx(B,{children:e.jsxs(_,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5"}),"إعدادات ZATCA"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"اسم المنشأة (عربي)"}),e.jsx(j,{defaultValue:t?.sellerName})]}),e.jsxs("div",{children:[e.jsx(l,{children:"اسم المنشأة (إنجليزي)"}),e.jsx(j,{defaultValue:t?.sellerNameEn})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"الرقم الضريبي (VAT)"}),e.jsx(j,{defaultValue:t?.vatNumber,placeholder:"3XXXXXXXXXX0003"})]}),e.jsxs("div",{children:[e.jsx(l,{children:"رقم السجل التجاري"}),e.jsx(j,{defaultValue:t?.crNumber})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"العنوان"}),e.jsx(j,{defaultValue:t?.address})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"المدينة"}),e.jsx(j,{defaultValue:t?.city})]}),e.jsxs("div",{children:[e.jsx(l,{children:"الرمز البريدي"}),e.jsx(j,{defaultValue:t?.postalCode})]}),e.jsxs("div",{children:[e.jsx(l,{children:"رقم المبنى"}),e.jsx(j,{defaultValue:t?.buildingNumber})]})]})]}),e.jsxs(H,{children:[e.jsx(r,{variant:"outline",onClick:()=>b(!1),children:"إلغاء"}),e.jsx(r,{className:"bg-primary hover:bg-primary",children:"حفظ الإعدادات"})]})]})})]})})}export{ds as default};
