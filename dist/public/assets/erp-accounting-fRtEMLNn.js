import{j as e}from"./vendor-ui-DJm-zmnP.js";import{r as w}from"./vendor-react-Bzsngnqy.js";import{a as P,b as I}from"./vendor-query-CX8ZYlKb.js";import{l as Ns,e as fs,B as d,N as m,q as b,aa as vs,ab as ys,ac as B,Z as Ne,ai as E,C as i,f as n,a0 as ws,a2 as Ss,r as Cs,x as C,y as A,V as fe,j as k,P as H,R as ie,D as Z,E as J,F as _,H as U,L as x,I as N,K as X,al as As,v as R}from"./index-CLvpp2UE.js";import{S as Y,a as G,b as W,c as ee,d as h}from"./select-BzAjeBJu.js";import{R as ks,C as Ds,a as Ls}from"./index-BN4CBDaN.js";import{T as M,a as V,b as f,c as t,d as z,e as a}from"./table-DVDQb40v.js";import{S as Ts}from"./scroll-area-DK2Y4dAh.js";import{R as Fs}from"./refresh-cw-BuGj2LMM.js";import{S as qs}from"./settings-CIxkmZWE.js";import{C as Ps}from"./chart-column-CfkHrk5y.js";import{R as ce}from"./receipt-7jFYni-X.js";import{B as Be}from"./building-2-H4-dEMu_.js";import{F as ve}from"./file-text-QZcL_gux.js";import{T as se}from"./trending-up-BzxeYQ4e.js";import{B as Ee}from"./book-open-DSeJOfJp.js";import{U as Ke}from"./users-Ce5vrIiy.js";import{T as ye}from"./trending-down-By0t33Hr.js";import{D as Bs}from"./dollar-sign-CFWcU9O3.js";import{R as we,B as Ie,C as Re,X as Qe,Y as $e,T as Se,N as Me,a as Es,L as Ks}from"./BarChart-C-BXurcz.js";import{P as Is,a as Rs}from"./PieChart-CcImm4lT.js";import{P as Qs}from"./piggy-bank-f6kkxB0t.js";import{C as Ce}from"./circle-check-big-DlXUvwLH.js";import{C as $s}from"./chevron-down-CqdH-ack.js";import{a as Ms,A as Vs}from"./arrow-up-right-3GAflgIx.js";import{f as de}from"./vendor-utils-BKCsaWdX.js";import{a as oe}from"./ar-CeWsqWSX.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=Ns("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]),zs=ks,Os=Ds,Hs=Ls,Ve={draft:"مسودة",issued:"صادرة",sent:"مرسلة",paid:"مدفوعة",partially_paid:"مدفوعة جزئياً",overdue:"متأخرة",cancelled:"ملغاة",voided:"ملغاة"},ze={draft:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",issued:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",sent:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",paid:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",partially_paid:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",overdue:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",cancelled:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",voided:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"},Oe={asset:"أصول",liability:"خصوم",equity:"حقوق ملكية",revenue:"إيرادات",expense:"مصروفات",contra:"حساب مقابل"},He={asset:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",liability:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",equity:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",revenue:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",expense:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"},Zs={draft:"مسودة",posted:"مرحل"},Js={draft:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",posted:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},_s={pending_approval:"بانتظار الموافقة",approved:"معتمد",rejected:"مرفوض",paid:"مدفوع"},Us={pending_approval:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",approved:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",rejected:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",paid:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},Xs={operating:"تشغيلية",salary:"رواتب",rent:"إيجار",utilities:"مرافق",marketing:"تسويق",maintenance:"صيانة",other:"أخرى"};function Ys(l){const D=[];function T(F){for(const j of F)D.push(j),j.children&&j.children.length>0&&T(j.children)}return T(l),D}function Ze({account:l,level:D=0}){const[T,F]=w.useState(D<2),j=l.children&&l.children.length>0;return e.jsx("div",{className:"border-b border-border/50 last:border-0",children:e.jsxs(zs,{open:T,onOpenChange:F,children:[e.jsxs("div",{className:"flex items-center gap-2 py-2 px-3 hover-elevate cursor-pointer",style:{paddingRight:`${D*20+12}px`},children:[j?e.jsx(Os,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"icon",className:"h-6 w-6",children:T?e.jsx($s,{className:"h-4 w-4"}):e.jsx(As,{className:"h-4 w-4"})})}):e.jsx("div",{className:"w-6"}),e.jsx("span",{className:"font-mono text-sm text-muted-foreground",children:l.accountNumber}),e.jsx("span",{className:"flex-1 font-medium",children:l.nameAr}),e.jsx(k,{className:He[l.accountType]||"bg-gray-100",children:Oe[l.accountType]}),e.jsxs("span",{className:"font-mono text-sm min-w-[100px] text-left",children:[l.currentBalance.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]}),j&&e.jsx(Hs,{children:l.children?.map(c=>e.jsx(Ze,{account:c,level:D+1},c.id))})]})})}function xe({title:l,value:D,icon:T,trend:F,trendValue:j,color:c}){return e.jsx(i,{className:"bg-card border-border/50",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:l}),e.jsxs("p",{className:"text-2xl font-bold mt-1",children:[D.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]}),F&&j&&e.jsxs("div",{className:`flex items-center gap-1 mt-1 text-xs ${F==="up"?"text-green-600":"text-red-600"}`,children:[F==="up"?e.jsx(Ms,{className:"h-3 w-3"}):e.jsx(Vs,{className:"h-3 w-3"}),j]})]}),e.jsx("div",{className:`p-3 rounded-full ${c}`,children:e.jsx(T,{className:"h-6 w-6 text-white"})})]})})})}function Ca(){const{toast:l}=fs(),[D,T]=w.useState("dashboard"),[F,j]=w.useState(!1),[c,Je]=w.useState(null),[_e,me]=w.useState(!1),[u,K]=w.useState({accountNumber:"",nameAr:"",nameEn:"",accountType:"asset",normalBalance:"debit",openingBalance:0,parentAccountId:""}),[Ue,ae]=w.useState(!1),[Xe,te]=w.useState(!1),[Ye,re]=w.useState(!1),[p,Q]=w.useState({description:"",lines:[{accountId:"",accountNumber:"",accountName:"",debit:0,credit:0},{accountId:"",accountNumber:"",accountName:"",debit:0,credit:0}]}),[q,ne]=w.useState({description:"",amount:0,category:"operating",accountId:""}),[v,$]=w.useState({nameAr:"",nameEn:"",phone:"",email:"",taxNumber:""}),{data:Ge,isLoading:We}=P({queryKey:["/api/erp/dashboard"]}),{data:es,isLoading:ss}=P({queryKey:["/api/erp/accounts/tree"]}),{data:as,isLoading:ts}=P({queryKey:["/api/erp/reports/trial-balance"]}),{data:rs,isLoading:ns}=P({queryKey:["/api/erp/reports/income-statement"]}),{data:ls,isLoading:is}=P({queryKey:["/api/erp/invoices"]}),{data:cs,isLoading:ds}=P({queryKey:["/api/erp/journal-entries"]}),{data:os,isLoading:xs}=P({queryKey:["/api/erp/expenses"]}),{data:ms,isLoading:hs}=P({queryKey:["/api/erp/vendors"]}),{data:us,isLoading:js}=P({queryKey:["/api/erp/reports/balance-sheet"]}),O=I({mutationFn:()=>R("POST","/api/erp/accounts/initialize"),onSuccess:()=>{m.invalidateQueries({queryKey:["/api/erp/accounts"]}),m.invalidateQueries({queryKey:["/api/erp/accounts/tree"]}),l({title:"تم إنشاء دليل الحسابات بنجاح"})},onError:()=>{l({title:"فشل في إنشاء دليل الحسابات",variant:"destructive"})}}),he=I({mutationFn:s=>R("POST","/api/erp/accounts",s),onSuccess:()=>{m.invalidateQueries({queryKey:["/api/erp/accounts"]}),m.invalidateQueries({queryKey:["/api/erp/accounts/tree"]}),j(!1),K({accountNumber:"",nameAr:"",nameEn:"",accountType:"asset",normalBalance:"debit",openingBalance:0,parentAccountId:""}),l({title:"تم إنشاء الحساب بنجاح"})},onError:s=>{l({title:s.message||"فشل في إنشاء الحساب",variant:"destructive"})}}),ue=I({mutationFn:s=>R("POST","/api/erp/journal-entries",s),onSuccess:()=>{m.invalidateQueries({queryKey:["/api/erp/journal-entries"]}),m.invalidateQueries({queryKey:["/api/erp/dashboard"]}),m.invalidateQueries({queryKey:["/api/erp/reports/trial-balance"]}),m.invalidateQueries({queryKey:["/api/erp/reports/income-statement"]}),m.invalidateQueries({queryKey:["/api/erp/reports/balance-sheet"]}),ae(!1),Q({description:"",lines:[{accountId:"",accountNumber:"",accountName:"",debit:0,credit:0},{accountId:"",accountNumber:"",accountName:"",debit:0,credit:0}]}),l({title:"تم إنشاء القيد بنجاح"})},onError:s=>{l({title:s.message||"فشل في إنشاء القيد",variant:"destructive"})}}),ke=I({mutationFn:s=>R("PATCH",`/api/erp/journal-entries/${s}/post`),onSuccess:()=>{m.invalidateQueries({queryKey:["/api/erp/journal-entries"]}),m.invalidateQueries({queryKey:["/api/erp/accounts/tree"]}),m.invalidateQueries({queryKey:["/api/erp/dashboard"]}),l({title:"تم ترحيل القيد بنجاح"})},onError:s=>{l({title:s.message||"فشل في ترحيل القيد",variant:"destructive"})}}),je=I({mutationFn:s=>R("POST","/api/erp/expenses",s),onSuccess:()=>{m.invalidateQueries({queryKey:["/api/erp/expenses"]}),m.invalidateQueries({queryKey:["/api/erp/dashboard"]}),te(!1),ne({description:"",amount:0,category:"operating",accountId:""}),l({title:"تم إضافة المصروف بنجاح"})},onError:s=>{l({title:s.message||"فشل في إضافة المصروف",variant:"destructive"})}}),De=I({mutationFn:s=>R("PATCH",`/api/erp/expenses/${s}/approve`),onSuccess:()=>{m.invalidateQueries({queryKey:["/api/erp/expenses"]}),m.invalidateQueries({queryKey:["/api/erp/dashboard"]}),l({title:"تم اعتماد المصروف بنجاح"})},onError:s=>{l({title:s.message||"فشل في اعتماد المصروف",variant:"destructive"})}}),pe=I({mutationFn:s=>R("POST","/api/erp/vendors",s),onSuccess:()=>{m.invalidateQueries({queryKey:["/api/erp/vendors"]}),re(!1),$({nameAr:"",nameEn:"",phone:"",email:"",taxNumber:""}),l({title:"تم إضافة المورد بنجاح"})},onError:s=>{l({title:s.message||"فشل في إضافة المورد",variant:"destructive"})}}),o=Ge?.summary,ge=es?.tree||[],le=as?.trialBalance||[],g=rs?.incomeStatement,Le=ls?.invoices||[],Te=cs?.entries||[],Fe=os?.expenses||[],qe=ms?.vendors||[],L=us?.balanceSheet,be=Ys(ge),ps=le.reduce((s,r)=>s+r.debitBalance,0),gs=le.reduce((s,r)=>s+r.creditBalance,0);return e.jsxs("div",{dir:"rtl",className:"min-h-screen bg-background p-4 md:p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold font-playfair text-foreground",children:"نظام المحاسبة ERP"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"إدارة الحسابات والتقارير المالية"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>{m.invalidateQueries({queryKey:["/api/erp"]})},"data-testid":"button-refresh",children:[e.jsx(Fs,{className:"h-4 w-4 ml-2"}),"تحديث"]}),e.jsxs(d,{onClick:()=>O.mutate(),disabled:O.isPending,"data-testid":"button-init-coa",children:[O.isPending?e.jsx(b,{className:"h-4 w-4 ml-2 animate-spin"}):e.jsx(qs,{className:"h-4 w-4 ml-2"}),"تهيئة دليل الحسابات"]})]})]}),e.jsxs(vs,{value:D,onValueChange:T,className:"space-y-4",children:[e.jsxs(ys,{className:"flex flex-wrap gap-1 h-auto p-1",children:[e.jsxs(B,{value:"dashboard","data-testid":"tab-dashboard",children:[e.jsx(Ps,{className:"h-4 w-4 ml-2"}),"لوحة التحكم"]}),e.jsxs(B,{value:"invoices","data-testid":"tab-invoices",children:[e.jsx(ce,{className:"h-4 w-4 ml-2"}),"الفواتير"]}),e.jsxs(B,{value:"accounts","data-testid":"tab-accounts",children:[e.jsx(Be,{className:"h-4 w-4 ml-2"}),"دليل الحسابات"]}),e.jsxs(B,{value:"trial-balance","data-testid":"tab-trial-balance",children:[e.jsx(ve,{className:"h-4 w-4 ml-2"}),"ميزان المراجعة"]}),e.jsxs(B,{value:"income","data-testid":"tab-income",children:[e.jsx(se,{className:"h-4 w-4 ml-2"}),"قائمة الدخل"]}),e.jsxs(B,{value:"journal-entries","data-testid":"tab-journal-entries",children:[e.jsx(Ee,{className:"h-4 w-4 ml-2"}),"القيود"]}),e.jsxs(B,{value:"expenses","data-testid":"tab-expenses",children:[e.jsx(Ne,{className:"h-4 w-4 ml-2"}),"المصروفات"]}),e.jsxs(B,{value:"vendors","data-testid":"tab-vendors",children:[e.jsx(Ke,{className:"h-4 w-4 ml-2"}),"الموردين"]}),e.jsxs(B,{value:"balance-sheet","data-testid":"tab-balance-sheet",children:[e.jsx(Ae,{className:"h-4 w-4 ml-2"}),"الميزانية"]})]}),e.jsx(E,{value:"dashboard",className:"space-y-6",children:We?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(b,{className:"h-8 w-8 animate-spin text-primary"})}):o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(xe,{title:"إجمالي الإيرادات",value:o.totalRevenue,icon:se,color:"bg-green-500",trend:"up",trendValue:"+12%"}),e.jsx(xe,{title:"إجمالي المصروفات",value:o.totalExpenses,icon:ye,color:"bg-red-500"}),e.jsx(xe,{title:"صافي الدخل",value:o.netIncome,icon:Bs,color:"bg-primary",trend:o.netIncome>0?"up":"down",trendValue:o.netIncome>0?"ربح":"خسارة"}),e.jsx(xe,{title:"رصيد الصندوق",value:o.cashBalance,icon:Ne,color:"bg-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(i,{className:"bg-card border-border/50",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-blue-100 dark:bg-blue-900",children:e.jsx(ws,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"الذمم المدينة"}),e.jsxs("p",{className:"text-lg font-bold",children:[o.accountsReceivable.toLocaleString("ar-SA")," ر.س"]})]})]})})}),e.jsx(i,{className:"bg-card border-border/50",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-red-100 dark:bg-red-900",children:e.jsx(Ss,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"الذمم الدائنة"}),e.jsxs("p",{className:"text-lg font-bold",children:[o.accountsPayable.toLocaleString("ar-SA")," ر.س"]})]})]})})}),e.jsx(i,{className:"bg-card border-border/50",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-orange-100 dark:bg-orange-900",children:e.jsx(Cs,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"مصروفات معلقة"}),e.jsx("p",{className:"text-lg font-bold",children:o.pendingExpenses})]})]})})}),e.jsx(i,{className:"bg-card border-border/50",children:e.jsx(n,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-purple-100 dark:bg-purple-900",children:e.jsx(ce,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"عدد الفواتير"}),e.jsx("p",{className:"text-lg font-bold",children:o.invoiceCount})]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{className:"bg-card border-border/50",children:[e.jsxs(C,{children:[e.jsx(A,{className:"text-lg",children:"الإيرادات مقابل المصروفات"}),e.jsx(fe,{children:"مقارنة الأداء المالي"})]}),e.jsx(n,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(we,{width:"100%",height:"100%",children:e.jsxs(Ie,{data:[{name:"الإيرادات",value:o.totalRevenue,fill:"#22c55e"},{name:"المصروفات",value:o.totalExpenses,fill:"#ef4444"},{name:"صافي الدخل",value:Math.abs(o.netIncome),fill:o.netIncome>=0?"#3b82f6":"#f97316"}],layout:"vertical",children:[e.jsx(Re,{strokeDasharray:"3 3"}),e.jsx(Qe,{type:"number",tickFormatter:s=>`${(s/1e3).toFixed(0)}k`}),e.jsx($e,{type:"category",dataKey:"name",width:80}),e.jsx(Se,{formatter:s=>[`${s.toLocaleString("ar-SA")} ر.س`,""],contentStyle:{direction:"rtl"}}),e.jsx(Me,{dataKey:"value",radius:[0,4,4,0]})]})})})})]}),e.jsxs(i,{className:"bg-card border-border/50",children:[e.jsxs(C,{children:[e.jsx(A,{className:"text-lg",children:"توزيع الأصول والخصوم"}),e.jsx(fe,{children:"المركز المالي"})]}),e.jsx(n,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(we,{width:"100%",height:"100%",children:e.jsxs(Is,{children:[e.jsx(Rs,{data:[{name:"رصيد الصندوق",value:o.cashBalance,color:"#3b82f6"},{name:"الذمم المدينة",value:o.accountsReceivable,color:"#22c55e"},{name:"الذمم الدائنة",value:o.accountsPayable,color:"#ef4444"}].filter(s=>s.value>0),cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",label:({name:s,percent:r})=>`${s} ${(r*100).toFixed(0)}%`,labelLine:!1,children:[{name:"رصيد الصندوق",value:o.cashBalance,color:"#3b82f6"},{name:"الذمم المدينة",value:o.accountsReceivable,color:"#22c55e"},{name:"الذمم الدائنة",value:o.accountsPayable,color:"#ef4444"}].filter(s=>s.value>0).map((s,r)=>e.jsx(Es,{fill:s.color},`cell-${r}`))}),e.jsx(Se,{formatter:s=>[`${s.toLocaleString("ar-SA")} ر.س`,""]}),e.jsx(Ks,{})]})})})})]})]}),g&&e.jsxs(i,{className:"bg-card border-border/50",children:[e.jsxs(C,{children:[e.jsx(A,{className:"text-lg",children:"تفاصيل قائمة الدخل"}),e.jsx(fe,{children:"الإيرادات والمصروفات حسب الفئة"})]}),e.jsx(n,{children:e.jsx("div",{className:"h-[350px]",children:e.jsx(we,{width:"100%",height:"100%",children:e.jsxs(Ie,{data:[...g.revenue.map(s=>({name:s.accountName.substring(0,15),amount:s.amount,type:"إيراد",fill:"#22c55e"})),...g.expenses.map(s=>({name:s.accountName.substring(0,15),amount:s.amount,type:"مصروف",fill:"#ef4444"}))],children:[e.jsx(Re,{strokeDasharray:"3 3"}),e.jsx(Qe,{dataKey:"name",angle:-45,textAnchor:"end",height:80,fontSize:12}),e.jsx($e,{tickFormatter:s=>`${(s/1e3).toFixed(0)}k`}),e.jsx(Se,{formatter:(s,r)=>[`${s.toLocaleString("ar-SA")} ر.س`,r==="amount"?"المبلغ":r],contentStyle:{direction:"rtl"}}),e.jsx(Me,{dataKey:"amount",radius:[4,4,0,0]})]})})})})]})]}):e.jsx(i,{className:"bg-card border-border/50",children:e.jsxs(n,{className:"p-12 text-center",children:[e.jsx(Qs,{className:"h-16 w-16 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"لا توجد بيانات"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"يرجى تهيئة دليل الحسابات أولاً"}),e.jsx(d,{onClick:()=>O.mutate(),disabled:O.isPending,children:"تهيئة دليل الحسابات"})]})})}),e.jsxs(E,{value:"invoices",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"الفواتير الضريبية"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(k,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"متوافق مع ZATCA"})})]}),e.jsx(i,{className:"bg-card border-border/50",children:is?e.jsx(n,{className:"p-12 text-center",children:e.jsx(b,{className:"h-8 w-8 animate-spin mx-auto text-primary"})}):Le.length>0?e.jsxs(M,{children:[e.jsx(V,{children:e.jsxs(f,{children:[e.jsx(t,{className:"text-right",children:"رقم الفاتورة"}),e.jsx(t,{className:"text-right",children:"التاريخ"}),e.jsx(t,{className:"text-right",children:"العميل"}),e.jsx(t,{className:"text-right",children:"الحالة"}),e.jsx(t,{className:"text-left",children:"الإجمالي"}),e.jsx(t,{className:"text-left",children:"الضريبة"}),e.jsx(t,{className:"text-center",children:"QR"}),e.jsx(t,{className:"text-center",children:"إجراءات"})]})}),e.jsx(z,{children:Le.map(s=>e.jsxs(f,{children:[e.jsx(a,{className:"font-mono font-medium",children:s.invoiceNumber}),e.jsx(a,{children:de(new Date(s.invoiceDate),"dd/MM/yyyy",{locale:oe})}),e.jsx(a,{children:s.customerName}),e.jsx(a,{children:e.jsx(k,{className:ze[s.status]||"bg-gray-100",children:Ve[s.status]||s.status})}),e.jsxs(a,{className:"text-left font-mono",children:[s.grandTotal.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]}),e.jsxs(a,{className:"text-left font-mono",children:[s.totalTax.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]}),e.jsx(a,{className:"text-center",children:s.zatcaQrCode?e.jsx(k,{className:"bg-green-100 text-green-800",children:e.jsx(Ce,{className:"h-3 w-3"})}):e.jsx(k,{className:"bg-gray-100 text-gray-600",children:"-"})}),e.jsx(a,{className:"text-center",children:e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>{Je(s),me(!0)},"data-testid":`button-view-invoice-${s.id}`,children:e.jsx(ve,{className:"h-4 w-4"})})})]},s.id))})]}):e.jsxs(n,{className:"p-12 text-center",children:[e.jsx(ce,{className:"h-16 w-16 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"لا توجد فواتير"}),e.jsx("p",{className:"text-muted-foreground",children:"سيتم عرض الفواتير الضريبية هنا"})]})})]}),e.jsxs(E,{value:"accounts",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"دليل الحسابات"}),e.jsxs(d,{onClick:()=>j(!0),"data-testid":"button-add-account",children:[e.jsx(H,{className:"h-4 w-4 ml-2"}),"إضافة حساب"]})]}),e.jsx(i,{className:"bg-card border-border/50",children:ss?e.jsx(n,{className:"p-12 text-center",children:e.jsx(b,{className:"h-8 w-8 animate-spin mx-auto text-primary"})}):ge.length>0?e.jsx(Ts,{className:"h-[600px]",children:e.jsx("div",{className:"p-4",children:ge.map(s=>e.jsx(Ze,{account:s},s.id))})}):e.jsxs(n,{className:"p-12 text-center",children:[e.jsx(Be,{className:"h-16 w-16 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"لا يوجد دليل حسابات"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"اضغط على تهيئة دليل الحسابات لإنشاء الحسابات الافتراضية"})]})})]}),e.jsxs(E,{value:"trial-balance",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"ميزان المراجعة"}),e.jsxs(d,{variant:"outline","data-testid":"button-export-trial-balance",children:[e.jsx(ie,{className:"h-4 w-4 ml-2"}),"تصدير"]})]}),e.jsx(i,{className:"bg-card border-border/50",children:ts?e.jsx(n,{className:"p-12 text-center",children:e.jsx(b,{className:"h-8 w-8 animate-spin mx-auto text-primary"})}):le.length>0?e.jsxs(M,{children:[e.jsx(V,{children:e.jsxs(f,{children:[e.jsx(t,{className:"text-right",children:"رقم الحساب"}),e.jsx(t,{className:"text-right",children:"اسم الحساب"}),e.jsx(t,{className:"text-right",children:"النوع"}),e.jsx(t,{className:"text-left",children:"مدين"}),e.jsx(t,{className:"text-left",children:"دائن"})]})}),e.jsxs(z,{children:[le.map((s,r)=>e.jsxs(f,{children:[e.jsx(a,{className:"font-mono",children:s.accountNumber}),e.jsx(a,{children:s.accountName}),e.jsx(a,{children:e.jsx(k,{className:He[s.accountType]||"bg-gray-100",children:Oe[s.accountType]})}),e.jsx(a,{className:"text-left font-mono",children:s.debitBalance>0?s.debitBalance.toLocaleString("ar-SA",{minimumFractionDigits:2}):"-"}),e.jsx(a,{className:"text-left font-mono",children:s.creditBalance>0?s.creditBalance.toLocaleString("ar-SA",{minimumFractionDigits:2}):"-"})]},r)),e.jsxs(f,{className:"bg-muted/50 font-bold",children:[e.jsx(a,{colSpan:3,className:"text-right",children:"المجموع"}),e.jsx(a,{className:"text-left font-mono",children:ps.toLocaleString("ar-SA",{minimumFractionDigits:2})}),e.jsx(a,{className:"text-left font-mono",children:gs.toLocaleString("ar-SA",{minimumFractionDigits:2})})]})]})]}):e.jsxs(n,{className:"p-12 text-center",children:[e.jsx(ve,{className:"h-16 w-16 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"لا توجد بيانات"}),e.jsx("p",{className:"text-muted-foreground",children:"يرجى تهيئة دليل الحسابات وإضافة قيود"})]})})]}),e.jsxs(E,{value:"income",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"قائمة الدخل"}),e.jsxs(d,{variant:"outline","data-testid":"button-export-income",children:[e.jsx(ie,{className:"h-4 w-4 ml-2"}),"تصدير"]})]}),ns?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(b,{className:"h-8 w-8 animate-spin text-primary"})}):g?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{className:"bg-card border-border/50",children:[e.jsx(C,{children:e.jsxs(A,{className:"text-lg flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5 text-green-600"}),"الإيرادات"]})}),e.jsxs(n,{className:"space-y-2",children:[g.revenue.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border/50",children:[e.jsx("span",{children:s.accountName}),e.jsxs("span",{className:"font-mono text-green-600",children:[s.amount.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]},r)),e.jsxs("div",{className:"flex items-center justify-between py-3 font-bold bg-green-50 dark:bg-green-900/20 px-3 rounded",children:[e.jsx("span",{children:"إجمالي الإيرادات"}),e.jsxs("span",{className:"font-mono text-green-600",children:[g.totalRevenue.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]})]})]}),e.jsxs(i,{className:"bg-card border-border/50",children:[e.jsx(C,{children:e.jsxs(A,{className:"text-lg flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5 text-red-600"}),"المصروفات"]})}),e.jsxs(n,{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border/50",children:[e.jsx("span",{children:"تكلفة البضاعة المباعة"}),e.jsxs("span",{className:"font-mono text-red-600",children:[g.cogs.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]}),g.expenses.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border/50",children:[e.jsx("span",{children:s.accountName}),e.jsxs("span",{className:"font-mono text-red-600",children:[s.amount.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]},r)),e.jsxs("div",{className:"flex items-center justify-between py-3 font-bold bg-red-50 dark:bg-red-900/20 px-3 rounded",children:[e.jsx("span",{children:"إجمالي المصروفات"}),e.jsxs("span",{className:"font-mono text-red-600",children:[(g.totalExpenses+g.cogs).toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]})]})]}),e.jsx(i,{className:"lg:col-span-2 bg-gradient-to-r from-primary/10 to-primary/5 border-primary/20",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-3 gap-6 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"إجمالي الربح"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[g.grossProfit.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]}),e.jsxs("div",{className:"border-x border-border",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"مصروفات التشغيل"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:[g.totalExpenses.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"صافي الدخل"}),e.jsxs("p",{className:`text-2xl font-bold ${g.netIncome>=0?"text-green-600":"text-red-600"}`,children:[g.netIncome.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]})]})})})]}):e.jsx(i,{className:"bg-card border-border/50",children:e.jsxs(n,{className:"p-12 text-center",children:[e.jsx(se,{className:"h-16 w-16 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"لا توجد بيانات"}),e.jsx("p",{className:"text-muted-foreground",children:"يرجى تهيئة دليل الحسابات وإضافة قيود"})]})})]}),e.jsxs(E,{value:"journal-entries",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"القيود المحاسبية"}),e.jsxs(d,{onClick:()=>ae(!0),"data-testid":"button-add-journal",children:[e.jsx(H,{className:"h-4 w-4 ml-2"}),"إضافة قيد"]})]}),e.jsx(i,{className:"bg-card border-border/50",children:ds?e.jsx(n,{className:"p-12 text-center",children:e.jsx(b,{className:"h-8 w-8 animate-spin mx-auto text-primary"})}):Te.length>0?e.jsxs(M,{children:[e.jsx(V,{children:e.jsxs(f,{children:[e.jsx(t,{className:"text-right",children:"رقم القيد"}),e.jsx(t,{className:"text-right",children:"التاريخ"}),e.jsx(t,{className:"text-right",children:"الوصف"}),e.jsx(t,{className:"text-left",children:"مدين"}),e.jsx(t,{className:"text-left",children:"دائن"}),e.jsx(t,{className:"text-right",children:"الحالة"}),e.jsx(t,{className:"text-center",children:"إجراءات"})]})}),e.jsx(z,{children:Te.map(s=>e.jsxs(f,{children:[e.jsx(a,{className:"font-mono font-medium",children:s.entryNumber}),e.jsx(a,{children:de(new Date(s.entryDate),"dd/MM/yyyy",{locale:oe})}),e.jsx(a,{children:s.description}),e.jsxs(a,{className:"text-left font-mono",children:[s.totalDebit.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]}),e.jsxs(a,{className:"text-left font-mono",children:[s.totalCredit.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]}),e.jsx(a,{children:e.jsx(k,{className:Js[s.status]||"bg-gray-100",children:Zs[s.status]||s.status})}),e.jsx(a,{className:"text-center",children:s.status==="draft"&&e.jsxs(d,{variant:"ghost",size:"sm",onClick:()=>ke.mutate(s.id),disabled:ke.isPending,"data-testid":`button-post-journal-${s.id}`,children:[e.jsx(Ce,{className:"h-4 w-4 ml-1"}),"ترحيل"]})})]},s.id))})]}):e.jsxs(n,{className:"p-12 text-center",children:[e.jsx(Ee,{className:"h-16 w-16 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"لا توجد قيود محاسبية"}),e.jsx("p",{className:"text-muted-foreground",children:"اضغط على إضافة قيد لإنشاء قيد جديد"})]})})]}),e.jsxs(E,{value:"expenses",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"المصروفات"}),e.jsxs(d,{onClick:()=>te(!0),"data-testid":"button-add-expense",children:[e.jsx(H,{className:"h-4 w-4 ml-2"}),"إضافة مصروف"]})]}),e.jsx(i,{className:"bg-card border-border/50",children:xs?e.jsx(n,{className:"p-12 text-center",children:e.jsx(b,{className:"h-8 w-8 animate-spin mx-auto text-primary"})}):Fe.length>0?e.jsxs(M,{children:[e.jsx(V,{children:e.jsxs(f,{children:[e.jsx(t,{className:"text-right",children:"الوصف"}),e.jsx(t,{className:"text-right",children:"الفئة"}),e.jsx(t,{className:"text-left",children:"المبلغ"}),e.jsx(t,{className:"text-right",children:"الحالة"}),e.jsx(t,{className:"text-right",children:"التاريخ"}),e.jsx(t,{className:"text-center",children:"إجراءات"})]})}),e.jsx(z,{children:Fe.map(s=>e.jsxs(f,{children:[e.jsx(a,{children:s.description}),e.jsx(a,{children:Xs[s.category]||s.category}),e.jsxs(a,{className:"text-left font-mono",children:[s.amount.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]}),e.jsx(a,{children:e.jsx(k,{className:Us[s.status]||"bg-gray-100",children:_s[s.status]||s.status})}),e.jsx(a,{children:de(new Date(s.createdAt),"dd/MM/yyyy",{locale:oe})}),e.jsx(a,{className:"text-center",children:s.status==="pending_approval"&&e.jsxs(d,{variant:"ghost",size:"sm",onClick:()=>De.mutate(s.id),disabled:De.isPending,"data-testid":`button-approve-expense-${s.id}`,children:[e.jsx(Ce,{className:"h-4 w-4 ml-1"}),"اعتماد"]})})]},s.id))})]}):e.jsxs(n,{className:"p-12 text-center",children:[e.jsx(Ne,{className:"h-16 w-16 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"لا توجد مصروفات"}),e.jsx("p",{className:"text-muted-foreground",children:"اضغط على إضافة مصروف لإنشاء مصروف جديد"})]})})]}),e.jsxs(E,{value:"vendors",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"الموردين"}),e.jsxs(d,{onClick:()=>re(!0),"data-testid":"button-add-vendor",children:[e.jsx(H,{className:"h-4 w-4 ml-2"}),"إضافة مورد"]})]}),e.jsx(i,{className:"bg-card border-border/50",children:hs?e.jsx(n,{className:"p-12 text-center",children:e.jsx(b,{className:"h-8 w-8 animate-spin mx-auto text-primary"})}):qe.length>0?e.jsxs(M,{children:[e.jsx(V,{children:e.jsxs(f,{children:[e.jsx(t,{className:"text-right",children:"الاسم (عربي)"}),e.jsx(t,{className:"text-right",children:"الاسم (إنجليزي)"}),e.jsx(t,{className:"text-right",children:"الهاتف"}),e.jsx(t,{className:"text-right",children:"البريد"}),e.jsx(t,{className:"text-right",children:"الرقم الضريبي"}),e.jsx(t,{className:"text-center",children:"الحالة"})]})}),e.jsx(z,{children:qe.map(s=>e.jsxs(f,{children:[e.jsx(a,{className:"font-medium",children:s.nameAr}),e.jsx(a,{children:s.nameEn||"-"}),e.jsx(a,{className:"font-mono",children:s.phone||"-"}),e.jsx(a,{children:s.email||"-"}),e.jsx(a,{className:"font-mono",children:s.taxNumber||"-"}),e.jsx(a,{className:"text-center",children:e.jsx(k,{className:s.isActive?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:s.isActive?"نشط":"غير نشط"})})]},s.id))})]}):e.jsxs(n,{className:"p-12 text-center",children:[e.jsx(Ke,{className:"h-16 w-16 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"لا يوجد موردين"}),e.jsx("p",{className:"text-muted-foreground",children:"اضغط على إضافة مورد لإنشاء مورد جديد"})]})})]}),e.jsxs(E,{value:"balance-sheet",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"الميزانية العمومية"}),e.jsxs(d,{variant:"outline","data-testid":"button-export-balance-sheet",children:[e.jsx(ie,{className:"h-4 w-4 ml-2"}),"تصدير"]})]}),js?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(b,{className:"h-8 w-8 animate-spin text-primary"})}):L?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(i,{className:"bg-card border-border/50",children:[e.jsx(C,{children:e.jsxs(A,{className:"text-lg flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5 text-green-600"}),"الأصول"]})}),e.jsxs(n,{className:"space-y-2",children:[L.assets.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border/50",children:[e.jsx("span",{children:s.accountName}),e.jsxs("span",{className:"font-mono text-green-600",children:[s.balance.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]},r)),e.jsxs("div",{className:"flex items-center justify-between py-3 font-bold bg-green-50 dark:bg-green-900/20 px-3 rounded",children:[e.jsx("span",{children:"إجمالي الأصول"}),e.jsxs("span",{className:"font-mono text-green-600",children:[L.totalAssets.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]})]})]}),e.jsxs(i,{className:"bg-card border-border/50",children:[e.jsx(C,{children:e.jsxs(A,{className:"text-lg flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5 text-red-600"}),"الخصوم"]})}),e.jsxs(n,{className:"space-y-2",children:[L.liabilities.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border/50",children:[e.jsx("span",{children:s.accountName}),e.jsxs("span",{className:"font-mono text-red-600",children:[s.balance.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]},r)),e.jsxs("div",{className:"flex items-center justify-between py-3 font-bold bg-red-50 dark:bg-red-900/20 px-3 rounded",children:[e.jsx("span",{children:"إجمالي الخصوم"}),e.jsxs("span",{className:"font-mono text-red-600",children:[L.totalLiabilities.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]})]})]}),e.jsxs(i,{className:"bg-card border-border/50",children:[e.jsx(C,{children:e.jsxs(A,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ae,{className:"h-5 w-5 text-purple-600"}),"حقوق الملكية"]})}),e.jsxs(n,{className:"space-y-2",children:[L.equity.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border/50",children:[e.jsx("span",{children:s.accountName}),e.jsxs("span",{className:"font-mono text-purple-600",children:[s.balance.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]},r)),e.jsxs("div",{className:"flex items-center justify-between py-3 font-bold bg-purple-50 dark:bg-purple-900/20 px-3 rounded",children:[e.jsx("span",{children:"إجمالي حقوق الملكية"}),e.jsxs("span",{className:"font-mono text-purple-600",children:[L.totalEquity.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]})]})]})]}),e.jsx(i,{className:"bg-gradient-to-r from-primary/10 to-primary/5 border-primary/20",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-3 gap-6 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"إجمالي الأصول"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[L.totalAssets.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]}),e.jsxs("div",{className:"border-x border-border",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"إجمالي الخصوم"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:[L.totalLiabilities.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"حقوق الملكية"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[L.totalEquity.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]})]})})})]}):e.jsx(i,{className:"bg-card border-border/50",children:e.jsxs(n,{className:"p-12 text-center",children:[e.jsx(Ae,{className:"h-16 w-16 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"لا توجد بيانات"}),e.jsx("p",{className:"text-muted-foreground",children:"يرجى تهيئة دليل الحسابات وإضافة قيود"})]})})]})]})]}),e.jsx(Z,{open:F,onOpenChange:j,children:e.jsxs(J,{className:"sm:max-w-[500px]",dir:"rtl",children:[e.jsx(_,{children:e.jsx(U,{children:"إضافة حساب جديد"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"رقم الحساب"}),e.jsx(N,{value:u.accountNumber,onChange:s=>K({...u,accountNumber:s.target.value}),placeholder:"مثال: 1115","data-testid":"input-account-number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"نوع الحساب"}),e.jsxs(Y,{value:u.accountType,onValueChange:s=>K({...u,accountType:s}),children:[e.jsx(G,{"data-testid":"select-account-type",children:e.jsx(W,{})}),e.jsxs(ee,{children:[e.jsx(h,{value:"asset",children:"أصول"}),e.jsx(h,{value:"liability",children:"خصوم"}),e.jsx(h,{value:"equity",children:"حقوق ملكية"}),e.jsx(h,{value:"revenue",children:"إيرادات"}),e.jsx(h,{value:"expense",children:"مصروفات"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"الحساب الأب (اختياري)"}),e.jsxs(Y,{value:u.parentAccountId||"none",onValueChange:s=>K({...u,parentAccountId:s==="none"?"":s}),children:[e.jsx(G,{"data-testid":"select-parent-account",children:e.jsx(W,{placeholder:"بدون حساب أب"})}),e.jsxs(ee,{children:[e.jsx(h,{value:"none",children:"بدون حساب أب"}),be.map(s=>e.jsxs(h,{value:s.id,children:[s.accountNumber," - ",s.nameAr]},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"اسم الحساب (عربي)"}),e.jsx(N,{value:u.nameAr,onChange:s=>K({...u,nameAr:s.target.value}),placeholder:"اسم الحساب","data-testid":"input-account-name-ar"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"اسم الحساب (إنجليزي)"}),e.jsx(N,{value:u.nameEn,onChange:s=>K({...u,nameEn:s.target.value}),placeholder:"Account Name","data-testid":"input-account-name-en"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"الطبيعة"}),e.jsxs(Y,{value:u.normalBalance,onValueChange:s=>K({...u,normalBalance:s}),children:[e.jsx(G,{"data-testid":"select-normal-balance",children:e.jsx(W,{})}),e.jsxs(ee,{children:[e.jsx(h,{value:"debit",children:"مدين"}),e.jsx(h,{value:"credit",children:"دائن"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"الرصيد الافتتاحي"}),e.jsx(N,{type:"number",value:u.openingBalance,onChange:s=>K({...u,openingBalance:parseFloat(s.target.value)||0}),"data-testid":"input-opening-balance"})]})]})]}),e.jsxs(X,{children:[e.jsx(d,{variant:"outline",onClick:()=>j(!1),children:"إلغاء"}),e.jsxs(d,{onClick:()=>he.mutate(u),disabled:he.isPending||!u.accountNumber||!u.nameAr,"data-testid":"button-submit-account",children:[he.isPending?e.jsx(b,{className:"h-4 w-4 ml-2 animate-spin"}):null,"إضافة"]})]})]})}),e.jsx(Z,{open:_e,onOpenChange:me,children:e.jsxs(J,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",dir:"rtl",children:[e.jsx(_,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5"}),"فاتورة ضريبية - ",c?.invoiceNumber]})}),c&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:ze[c.status]||"bg-gray-100",children:Ve[c.status]}),c.zatcaQrCode&&e.jsx(k,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:"متوافق مع ZATCA"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["التاريخ: ",de(new Date(c.invoiceDate),"dd/MM/yyyy HH:mm",{locale:oe})]})]}),c.zatcaQrCode&&e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:c.zatcaQrCode,alt:"ZATCA QR Code",className:"w-32 h-32 border rounded-lg","data-testid":"img-zatca-qr"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"رمز ZATCA"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(i,{className:"bg-muted/30",children:[e.jsx(C,{className:"pb-2",children:e.jsx(A,{className:"text-sm",children:"بيانات العميل"})}),e.jsxs(n,{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"الاسم:"})," ",c.customerName]}),c.customerPhone&&e.jsxs("p",{children:[e.jsx("strong",{children:"الهاتف:"})," ",c.customerPhone]}),c.customerTaxNumber&&e.jsxs("p",{children:[e.jsx("strong",{children:"الرقم الضريبي:"})," ",c.customerTaxNumber]})]})]}),e.jsxs(i,{className:"bg-muted/30",children:[e.jsx(C,{className:"pb-2",children:e.jsx(A,{className:"text-sm",children:"ملخص الفاتورة"})}),e.jsxs(n,{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"المجموع الفرعي:"}),e.jsxs("span",{className:"font-mono",children:[c.subtotal.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]}),c.totalDiscount>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"الخصم:"}),e.jsxs("span",{className:"font-mono",children:["-",c.totalDiscount.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"ضريبة القيمة المضافة (15%):"}),e.jsxs("span",{className:"font-mono",children:[c.totalTax.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]}),e.jsxs("div",{className:"flex justify-between font-bold border-t pt-1",children:[e.jsx("span",{children:"الإجمالي:"}),e.jsxs("span",{className:"font-mono",children:[c.grandTotal.toLocaleString("ar-SA",{minimumFractionDigits:2})," ر.س"]})]})]})]})]}),e.jsxs(i,{children:[e.jsx(C,{className:"pb-2",children:e.jsx(A,{className:"text-sm",children:"تفاصيل البنود"})}),e.jsx(n,{children:e.jsxs(M,{children:[e.jsx(V,{children:e.jsxs(f,{children:[e.jsx(t,{className:"text-right",children:"الوصف"}),e.jsx(t,{className:"text-center",children:"الكمية"}),e.jsx(t,{className:"text-left",children:"السعر"}),e.jsx(t,{className:"text-left",children:"الضريبة"}),e.jsx(t,{className:"text-left",children:"الإجمالي"})]})}),e.jsx(z,{children:c.lines?.map((s,r)=>e.jsxs(f,{children:[e.jsx(a,{children:s.description}),e.jsx(a,{className:"text-center",children:s.quantity}),e.jsx(a,{className:"text-left font-mono",children:s.unitPrice.toLocaleString("ar-SA",{minimumFractionDigits:2})}),e.jsx(a,{className:"text-left font-mono",children:s.taxAmount.toLocaleString("ar-SA",{minimumFractionDigits:2})}),e.jsx(a,{className:"text-left font-mono font-medium",children:s.lineTotal.toLocaleString("ar-SA",{minimumFractionDigits:2})})]},r))})]})})]}),c.zatcaHash&&e.jsxs("div",{className:"text-xs text-muted-foreground bg-muted/30 p-3 rounded-lg",children:[e.jsx("p",{className:"font-medium mb-1",children:"ZATCA TLV Hash:"}),e.jsx("code",{className:"break-all",children:c.zatcaHash})]})]}),e.jsxs(X,{children:[e.jsx(d,{variant:"outline",onClick:()=>me(!1),children:"إغلاق"}),e.jsxs(d,{variant:"default","data-testid":"button-print-invoice",children:[e.jsx(ie,{className:"h-4 w-4 ml-2"}),"طباعة"]})]})]})}),e.jsx(Z,{open:Ue,onOpenChange:ae,children:e.jsxs(J,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",dir:"rtl",children:[e.jsx(_,{children:e.jsx(U,{children:"إضافة قيد محاسبي"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"الوصف"}),e.jsx(N,{value:p.description,onChange:s=>Q({...p,description:s.target.value}),placeholder:"وصف القيد","data-testid":"input-journal-description"})]}),p.lines.map((s,r)=>e.jsxs("div",{className:"grid grid-cols-3 gap-3 p-3 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"الحساب"}),e.jsxs(Y,{value:s.accountId||"none",onValueChange:y=>{const S=[...p.lines],Pe=be.find(bs=>bs.id===y);S[r]={...S[r],accountId:y==="none"?"":y,accountNumber:Pe?.accountNumber||"",accountName:Pe?.nameAr||""},Q({...p,lines:S})},children:[e.jsx(G,{"data-testid":`select-journal-line-account-${r}`,children:e.jsx(W,{placeholder:"اختر حساب"})}),e.jsxs(ee,{children:[e.jsx(h,{value:"none",children:"اختر حساب"}),be.map(y=>e.jsxs(h,{value:y.id,children:[y.accountNumber," - ",y.nameAr]},y.id))]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"مدين"}),e.jsx(N,{type:"number",value:s.debit,onChange:y=>{const S=[...p.lines];S[r]={...S[r],debit:parseFloat(y.target.value)||0},Q({...p,lines:S})},"data-testid":`input-journal-line-debit-${r}`})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(x,{className:"text-xs",children:"دائن"}),e.jsx(N,{type:"number",value:s.credit,onChange:y=>{const S=[...p.lines];S[r]={...S[r],credit:parseFloat(y.target.value)||0},Q({...p,lines:S})},"data-testid":`input-journal-line-credit-${r}`})]})]},r)),e.jsxs(d,{variant:"outline",onClick:()=>Q({...p,lines:[...p.lines,{accountId:"",accountNumber:"",accountName:"",debit:0,credit:0}]}),"data-testid":"button-add-journal-line",children:[e.jsx(H,{className:"h-4 w-4 ml-2"}),"إضافة سطر"]})]}),e.jsxs(X,{children:[e.jsx(d,{variant:"outline",onClick:()=>ae(!1),children:"إلغاء"}),e.jsxs(d,{onClick:()=>ue.mutate({description:p.description,lines:p.lines,autoPost:!0,entryDate:new Date}),disabled:ue.isPending||!p.description,"data-testid":"button-submit-journal",children:[ue.isPending?e.jsx(b,{className:"h-4 w-4 ml-2 animate-spin"}):null,"إنشاء القيد"]})]})]})}),e.jsx(Z,{open:Xe,onOpenChange:te,children:e.jsxs(J,{className:"sm:max-w-[500px]",dir:"rtl",children:[e.jsx(_,{children:e.jsx(U,{children:"إضافة مصروف"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"الوصف"}),e.jsx(N,{value:q.description,onChange:s=>ne({...q,description:s.target.value}),placeholder:"وصف المصروف","data-testid":"input-expense-description"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"المبلغ"}),e.jsx(N,{type:"number",value:q.amount,onChange:s=>ne({...q,amount:parseFloat(s.target.value)||0}),"data-testid":"input-expense-amount"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"الفئة"}),e.jsxs(Y,{value:q.category,onValueChange:s=>ne({...q,category:s}),children:[e.jsx(G,{"data-testid":"select-expense-category",children:e.jsx(W,{})}),e.jsxs(ee,{children:[e.jsx(h,{value:"operating",children:"تشغيلية"}),e.jsx(h,{value:"salary",children:"رواتب"}),e.jsx(h,{value:"rent",children:"إيجار"}),e.jsx(h,{value:"utilities",children:"مرافق"}),e.jsx(h,{value:"marketing",children:"تسويق"}),e.jsx(h,{value:"maintenance",children:"صيانة"}),e.jsx(h,{value:"other",children:"أخرى"})]})]})]})]})]}),e.jsxs(X,{children:[e.jsx(d,{variant:"outline",onClick:()=>te(!1),children:"إلغاء"}),e.jsxs(d,{onClick:()=>je.mutate(q),disabled:je.isPending||!q.description||q.amount<=0,"data-testid":"button-submit-expense",children:[je.isPending?e.jsx(b,{className:"h-4 w-4 ml-2 animate-spin"}):null,"إضافة"]})]})]})}),e.jsx(Z,{open:Ye,onOpenChange:re,children:e.jsxs(J,{className:"sm:max-w-[500px]",dir:"rtl",children:[e.jsx(_,{children:e.jsx(U,{children:"إضافة مورد"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"اسم المورد (عربي)"}),e.jsx(N,{value:v.nameAr,onChange:s=>$({...v,nameAr:s.target.value}),placeholder:"اسم المورد بالعربي","data-testid":"input-vendor-name-ar"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"اسم المورد (إنجليزي)"}),e.jsx(N,{value:v.nameEn,onChange:s=>$({...v,nameEn:s.target.value}),placeholder:"Vendor Name","data-testid":"input-vendor-name-en"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"الهاتف"}),e.jsx(N,{value:v.phone,onChange:s=>$({...v,phone:s.target.value}),placeholder:"رقم الهاتف","data-testid":"input-vendor-phone"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"البريد الإلكتروني"}),e.jsx(N,{value:v.email,onChange:s=>$({...v,email:s.target.value}),placeholder:"email@example.com","data-testid":"input-vendor-email"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"الرقم الضريبي"}),e.jsx(N,{value:v.taxNumber,onChange:s=>$({...v,taxNumber:s.target.value}),placeholder:"الرقم الضريبي","data-testid":"input-vendor-tax-number"})]})]}),e.jsxs(X,{children:[e.jsx(d,{variant:"outline",onClick:()=>re(!1),children:"إلغاء"}),e.jsxs(d,{onClick:()=>pe.mutate(v),disabled:pe.isPending||!v.nameAr,"data-testid":"button-submit-vendor",children:[pe.isPending?e.jsx(b,{className:"h-4 w-4 ml-2 animate-spin"}):null,"إضافة"]})]})]})})]})}export{Ca as default};
