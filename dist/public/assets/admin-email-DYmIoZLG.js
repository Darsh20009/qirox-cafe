import{j as e}from"./vendor-ui-DJm-zmnP.js";import{r as l}from"./vendor-react-Bzsngnqy.js";import{a as p,b as j}from"./vendor-query-CX8ZYlKb.js";import{e as h,C as S,x as f,y as g,aj as v,V as C,f as N,I as y,a7 as b,B as w,q as I,v as T}from"./index-CLvpp2UE.js";import{S as E,a as q,b as M,c as P,d as V}from"./select-BzAjeBJu.js";import{S as B}from"./send-tv7GiiF9.js";import"./vendor-utils-BKCsaWdX.js";import"./chevron-down-CqdH-ack.js";function Q(){const{toast:a}=h(),[t,c]=l.useState(""),[i,d]=l.useState(""),[n,m]=l.useState(""),{data:o,isLoading:u}=p({queryKey:["/api/admin/customers-list"]}),r=j({mutationFn:async s=>(await T("POST","/api/admin/send-email",s)).json(),onSuccess:()=>{a({title:"تم الإرسال بنجاح",description:"تم إرسال البريد الإلكتروني للعميل بنجاح."}),d(""),m(""),c("")},onError:s=>{a({title:"فشل الإرسال",description:s.message||"حدث خطأ أثناء إرسال البريد الإلكتروني.",variant:"destructive"})}}),x=()=>{if(!t||!i||!n){a({title:"تنبيه",description:"يرجى ملء جميع الحقول المطلوبة.",variant:"destructive"});return}r.mutate({customerId:t,subject:i,message:n})};return e.jsx("div",{className:"container mx-auto p-6 max-w-2xl",children:e.jsxs(S,{children:[e.jsxs(f,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-6 w-6 text-primary"}),"إرسال بريد إلكتروني للعملاء"]}),e.jsx(C,{children:"أرسل رسائل مخصصة أو عروض ترويجية لعملائك المسجلين."})]}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"اختر العميل"}),e.jsxs(E,{value:t,onValueChange:c,children:[e.jsx(q,{children:e.jsx(M,{placeholder:u?"جاري التحميل...":"اختر عميلاً"})}),e.jsx(P,{children:o?.map(s=>e.jsxs(V,{value:s.id,children:[s.name," (",s.email,")"]},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"الموضوع"}),e.jsx(y,{placeholder:"أدخل موضوع الرسالة",value:i,onChange:s=>d(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"الرسالة"}),e.jsx(b,{placeholder:"اكتب رسالتك هنا...",className:"min-h-[150px]",value:n,onChange:s=>m(s.target.value)})]}),e.jsxs(w,{className:"w-full gap-2",onClick:x,disabled:r.isPending,children:[r.isPending?e.jsx(I,{className:"h-4 w-4 animate-spin"}):e.jsx(B,{className:"h-4 w-4"}),"إرسال البريد الإلكتروني"]})]})]})})}export{Q as default};
